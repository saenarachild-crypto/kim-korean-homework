import fitz  # PyMuPDF
import os

def extract_visual_elements(pdf_path, output_folder):
    # 저장할 폴더 생성
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)

    # PDF 문서 열기
    doc = fitz.open(pdf_path)

    for page_index in range(len(doc)):
        page = doc[page_index]
        image_list = page.get_images(full=True)

        if image_list:
            print(f"페이지 {page_index + 1}: {len(image_list)}개의 시각 자료 발견")
            
            for img_index, img in enumerate(image_list):
                xref = img[0]
                base_image = doc.extract_image(xref)
                image_bytes = base_image["image"]
                image_ext = base_image["ext"]
                
                # 파일명 설정 (예: page1_img1.png)
                image_name = f"page{page_index + 1}_img{img_index + 1}.{image_ext}"
                with open(os.path.join(output_folder, image_name), "wb") as f:
                    f.write(image_bytes)
                print(f"  - 저장 완료: {image_name}")
        else:
            print(f"페이지 {page_index + 1}: 추출할 이미지 객체 없음")

# 실행 예시
extract_visual_elements("your_exam_file.pdf", "extracted_images")