<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>í•œë°±ê³  êµ­ì–´ ê³¼ì œ ì‹œìŠ¤í…œ</title>
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js"></script>
    <style>
        body { font-family: 'Apple SD Gothic Neo', sans-serif; background: #f0f2f5; padding: 15px; margin: 0; color: #333; }
        .container { max-width: 600px; margin: 0 auto; background: #fff; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #1a73e8; margin-bottom: 20px; }
        #examSelect { width: 100%; padding: 15px; border-radius: 12px; border: 2px solid #e1e4e8; font-size: 1rem; margin-bottom: 20px; outline: none; }
        .qBox { display: flex; justify-content: space-between; align-items: center; padding: 12px 5px; border-bottom: 1px solid #f1f3f4; }
        .qNum { font-weight: bold; color: #5f6368; }
        .qChoices { display: flex; gap: 8px; }
        .choice input { display: none; }
        .choice span { 
            display: inline-block; width: 35px; height: 35px; line-height: 35px; text-align: center; 
            border: 1px solid #ddd; border-radius: 50%; font-weight: bold; cursor: pointer; transition: 0.2s;
        }
        .choice input:checked + span { background: #1a73e8; color: white; border-color: #1a73e8; transform: scale(1.1); }
        .btn { width: 100%; padding: 16px; border-radius: 12px; font-weight: bold; font-size: 1.1rem; border: none; cursor: pointer; margin-top: 12px; display: block; text-align: center; text-decoration: none; box-sizing: border-box; }
        #subBtn { background: #ff5252; color: white; }
        #kakaoBtn { background: #fee500; color: #3c1e1e; display: none; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“– êµ­ì–´ ê³¼ì œ ì œì¶œ</h2>

    <select id="examSelect" onchange="loadExam()">
        <option value="">ğŸ“ ê³¼ì œ íšŒì°¨ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
        <option value="week3">1ì›” 3ì£¼ì°¨ ì£¼ê°„ì§€</option>
        <option value="week4">1ì›” 4ì£¼ì°¨ ì£¼ê°„ì§€</option>
    </select>

    <div id="qArea"></div>

    <button id="subBtn" class="btn" onclick="submit()">ğŸ“ ì±„ì  ë° ê²°ê³¼ ì œì¶œ</button>
    <a id="kakaoBtn" class="btn" onclick="share()">ğŸŸ¡ ì¹´í†¡ìœ¼ë¡œ ê²°ê³¼ ê³µìœ </a>
</div>

<script>
// [ì¸ì¦ ì™„ë£Œ] ì„ ìƒë‹˜ì˜ ì „ìš© ì„¤ì •ê°’
const KAKAO_KEY = "f81d5eae0eaaf6fa2d0bdccbe6916001";
const OFFICIAL_DOMAIN = "https://saenarachild-crypto.github.io";
const SHEET_URL = "https://script.google.com/macros/s/AKfycbxjptIp4RB3K14-RMaY_r1UgHv2o1NG7_XNAbr5h35rEKE2q_UqG_e-OElXGOi58aVH/exec";

// ì¹´ì¹´ì˜¤ ì´ˆê¸°í™”
try { if (!Kakao.isInitialized()) Kakao.init(KAKAO_KEY); } catch (e) { console.error(e); }

// ê³¼ì œ ì •ë‹µ ë°ì´í„°
const exams = {
    week3: { title: "1ì›” 3ì£¼ì°¨", ans: [3,1,1,4,5,4] },
    week4: { title: "1ì›” 4ì£¼ì°¨", ans: [2,3,4,1,5,2] }
};

let correct = [], resultText = "", currentTitle = "";

function loadExam() {
    const k = document.getElementById("examSelect").value;
    if (!k) { document.getElementById("qArea").innerHTML = ""; return; }
    
    correct = exams[k].ans;
    currentTitle = exams[k].title;
    
    let h = "";
    correct.forEach((_, i) => {
        h += `<div class="qBox"><div class="qNum">${i + 1}ë²ˆ</div><div class="qChoices">`;
        for (let j = 1; j <= 5; j++) {
            h += `<label class="choice"><input type="radio" name="q${i}" value="${j}"><span>${j}</span></label>`;
        }
        h += `</div></div>`;
    });
    document.getElementById("qArea").innerHTML = h;
    document.getElementById("subBtn").style.display = "block";
    document.getElementById("kakaoBtn").style.display = "none";
}

async function submit() {
    const h = prompt("í•™ì›ëª… (ì˜ˆ: í•œë°±ê³ ì „)");
    const n = prompt("í•™ìƒ ì´ë¦„");
    if (!h || !n) { alert("í•™ì›ëª…ê³¼ ì´ë¦„ì„ ì…ë ¥í•´ì•¼ ì œì¶œë©ë‹ˆë‹¤."); return; }

    let w = 0, wrong = [];
    correct.forEach((ans, i) => {
        const sel = document.querySelector(`input[name="q${i}"]:checked`);
        const v = sel ? parseInt(sel.value) : 0;
        if (v !== ans) { w++; wrong.push(i + 1); }
    });

    resultText = `[${currentTitle}]\nğŸ“Œ í•™ì›: ${h}\nğŸ‘¤ í•™ìƒ: ${n}\nâŒ ì˜¤ë‹µ: ${w}ê°œ\nâ¡ï¸ ë²ˆí˜¸: ${wrong.join(", ") || "ë§Œì !"}`;

    // 1. êµ¬ê¸€ ì‹œíŠ¸ë¡œ ë°ì´í„° ì „ì†¡ (ìë™ ì„±ì í‘œ ê¸°ë¡)
    fetch(SHEET_URL, {
        method: "POST",
        mode: "no-cors", // êµ¬ê¸€ ìŠ¤í¬ë¦½íŠ¸ íŠ¹ì„±ìƒ no-cors ì„¤ì •ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        body: JSON.stringify({ academy: h, name: n, wrongCount: w, wrongDetails: wrong.join(", "), title: currentTitle })
    }).catch(e => console.error("ì „ì†¡ ì—ëŸ¬:", e));

    alert(`ì±„ì  ì™„ë£Œ! ì˜¤ë‹µì€ ${w}ê°œì…ë‹ˆë‹¤. [í™•ì¸]ì„ ëˆ„ë¥´ë©´ ì¹´í†¡ ì „ì†¡ ë²„íŠ¼ì´ ìƒê¹ë‹ˆë‹¤.`);
    document.getElementById("subBtn").style.display = "none";
    document.getElementById("kakaoBtn").style.display = "block";
}

function share() {
    // 4019 ì—ëŸ¬ ë°©ì§€ë¥¼ ìœ„í•œ ìµœì¢… ì¸ì¦ ë¡œì§
    Kakao.Share.sendDefault({
        objectType: "text",
        text: resultText,
        link: { mobileWebUrl: OFFICIAL_DOMAIN, webUrl: OFFICIAL_DOMAIN }
    });
}
</script>
</body>
</html>