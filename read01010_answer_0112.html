<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>1ì›” 1ì£¼ì°¨ ê³¼ì œ [ë…ì„œ]</title>
    <style>
        body{font-family:-apple-system,sans-serif;background:#f0f2f5;padding:15px;margin:0}
        .container{max-width:600px;margin:0 auto;background:#fff;padding:25px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.1)}
        .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #f0f0f0; padding-bottom: 15px; }
        .title { margin: 5px 0; color: #333; }
        .notice-box { background: #fff3e0; border: 1px solid #ffe0b2; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 0.95rem; line-height: 1.5; color: #5d4037; }
        .link-btn { display: block; width: 100%; text-align: center; padding: 12px; border-radius: 8px; text-decoration: none; font-weight: bold; margin-bottom: 10px; transition: 0.2s; box-sizing: border-box; }
        .btn-test { background: #607d8b; color: white; }
        .btn-ans { background: #4caf50; color: white; margin-top: 15px; }
        .q-item { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; display: flex; align-items: center; justify-content: space-between; }
        .q-num { font-weight: bold; color: #2196f3; width: 40px; }
        
        /* ì œì™¸ ë¬¸í•­ ì „ìš© ìŠ¤íƒ€ì¼ */
        .skipped-item { background: #f5f5f5; opacity: 0.6; pointer-events: none; }
        .skipped-msg { color: #d32f2f; font-weight: bold; font-size: 0.8rem; }

        .omr-group { display: flex; gap: 8px; flex: 1; justify-content: space-around; }
        .omr-input { display: none; }
        .omr-label { width: 35px; height: 35px; border-radius: 50%; border: 2px solid #ddd; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #999; cursor: pointer; transition: 0.2s; }
        .omr-input:checked + .omr-label { background: #2196f3; border-color: #2196f3; color: white; }
        .btn-submit { display: block; width: 100%; padding: 15px; background: #ff6b6b; color: white; border: none; border-radius: 10px; font-weight: bold; font-size: 1.1rem; cursor: pointer; margin-top:20px; }
        .result-box { display: none; margin-top: 25px; padding: 20px; border-radius: 10px; text-align: center; background: #e3f2fd; }
        input[type=text] { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h2 class="title">1ì›” 1ì£¼ì°¨ ê³¼ì œ [ë…ì„œ]</h2>
        <div id="totalInfo" style="font-size:0.9rem; color:#666">ì´ 39ë¬¸í•­ (ì œì™¸ ë¬¸í•­ ë§ˆí‚¹ ë¶ˆê°€)</div>
    </div>
    
    <a href="https://goe2427-my.sharepoint.com/:b:/g/personal/pure173_jeonghyeonh_goe_go_kr/IQAIYWBZgMIwS77MZq3A52QaAWNiPgGzGx1bGhMOHCqNxB8?e=6mwjLq" class="link-btn btn-test" target="_blank">ğŸ“„ ì‹œí—˜ì§€ ë³´ëŸ¬ê°€ê¸° (Click)</a>
    <div class="notice-box">ğŸ“¢ <b>ê³µì§€ì‚¬í•­</b><br>ìµœì¢… ìˆ˜ì •ë³¸ì…ë‹ˆë‹¤. ì •ë‹µì´ ê°±ì‹ ë˜ì—ˆìœ¼ë©° í•™ìŠµ ì œì™¸ ë¬¸í•­ì€ ë§ˆí‚¹ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>

    <div style="margin-bottom:20px; background:#fafafa; padding:15px; border-radius:8px;">
        <label style="font-weight:bold; color:#d63031;">ğŸ« í•™ì› ì´ë¦„ (í•„ìˆ˜)</label>
        <input type="text" id="academySelect" placeholder="ì˜ˆ: ëŸ¬ì…€ë¶„ë‹¹, ì‹œëŒ€ì¸ì¬ (ì •í™•íˆ ì…ë ¥)">
        <label style="font-weight:bold; margin-top:10px; display:block;">ğŸ‘¤ í•™ìƒ ì´ë¦„</label>
        <input type="text" id="studentName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
    </div>

    <div id="questionContainer"></div>
    <button id="submitBtn" class="btn-submit" onclick="checkAnswers()">ğŸ“ ì œì¶œí•˜ê³  ì±„ì í•˜ê¸°</button>
    <div id="resultArea" class="result-box"></div>
</div>

<script>
    // âœ… ìµœì‹  êµ¬ê¸€ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ URL
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby_X6gunMNnMD4lJa-lGSuUr64AO-CpJncl6a27KBILD6uR9cqz_PomnnPLYs9fO1cX/exec"; 
    
    // âœ… ì§ì ‘ ì•Œë ¤ì£¼ì‹  39ë¬¸í•­ ì •ë‹µ ë²ˆí˜¸ ë°˜ì˜
    const correctAnswers = [2, 5, 4, 3, 1, 3, 2, 1, 4, 3, 4, 2, 3, 4, 1, 5, 1, 4, 2, 2, 1, 1, 3, 2, 1, 2, 1, 2, 4, 3, 1, 4, 2, 1, 2, 4, 1, 3, 2];
    
    // âœ… í•™ìŠµ ì œì™¸ ë¬¸í•­ ë¦¬ìŠ¤íŠ¸
    const skipList = [1, 2, 3, 4, 5, 16, 17, 18, 19, 20, 21, 26, 27, 28, 29, 37, 38, 39]; 
    
    const ANSWER_LINK = "https://goe2427-my.sharepoint.com/:b:/g/personal/pure173_jeonghyeonh_goe_go_kr/IQAR3QCtHuECRrgVVSzX7Tp3AaSURvEE8NMKARWdtSyWt20?e=9uL8nC"; 
    const totalQ = correctAnswers.length;

    window.onload = function() {
        let html = "";
        for(let i=1; i<=totalQ; i++) {
            let isSkip = skipList.includes(i);
            let extraClass = isSkip ? "skipped-item" : "";
            let skipLabel = isSkip ? '<span class="skipped-msg">(ì œì™¸)</span>' : "";
            
            html += `<div class="q-item ${extraClass}" id="qRow${i}">
                        <span class="q-num">${i}ë²ˆ ${skipLabel}</span>
                        <div class="omr-group">`;
            
            if(!isSkip) {
                for(let j=1; j<=5; j++) {
                    html += `<input type="radio" name="q${i}" id="q${i}_${j}" value="${j}" class="omr-input">
                             <label for="q${i}_${j}" class="omr-label">${j}</label>`;
                }
            }
            html += `</div></div>`;
        }
        document.getElementById("questionContainer").innerHTML = html;
    };

    function checkAnswers() {
        const name = document.getElementById("studentName").value.trim();
        const academy = document.getElementById("academySelect").value.trim(); 
        if(!academy || !name) return alert("ì´ë¦„ê³¼ í•™ì›ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");

        for(let i=1; i<=totalQ; i++) {
            if(!skipList.includes(i) && !document.querySelector(`input[name="q${i}"]:checked`)) {
                return alert(i + "ë²ˆ ë¬¸ì œë¥¼ ì•„ì§ ì•ˆ í’€ì—ˆìŠµë‹ˆë‹¤!");
            }
        }

        let wrongCount = 0;
        let wrongList = [];
        for(let i=0; i<totalQ; i++) {
            if(skipList.includes(i+1)) continue;
            
            const r = document.querySelector(`input[name="q${i+1}"]:checked`);
            if(parseInt(r.value) !== correctAnswers[i]) {
                wrongCount++;
                wrongList.push(i + 1);
            } 
        }

        const activeTotal = totalQ - skipList.length;
        const sendData = {
            title: document.title,
            academy: academy,
            name: name,
            score: activeTotal - wrongCount,
            total: activeTotal,
            wrongCount: wrongCount,
            wrongList: wrongList.join(", ")
        };

        // ë°ì´í„° ì•”í˜¸í™” ë° GET ì „ì†¡
        const payload = btoa(unescape(encodeURIComponent(JSON.stringify(sendData))));
        fetch(SCRIPT_URL + "?data=" + payload, { mode: 'no-cors' });

        const res = document.getElementById("resultArea");
        res.style.display = "block";
        res.innerHTML = `<h3>ì±„ì  ì™„ë£Œ</h3><p>${name} í•™ìƒ, ì´ ${wrongCount}ê°œ í‹€ë ¸ìŠµë‹ˆë‹¤.</p>`;
        res.innerHTML += `<a href="${ANSWER_LINK}" class="link-btn btn-ans" target="_blank">ğŸ“˜ ì •ë‹µ ë° í•´ì„¤ ë³´ê¸° (Click)</a>`;
        
        document.getElementById("submitBtn").style.display = "none";
        res.scrollIntoView({behavior:"smooth"});
    }
</script>
</body>
</html>