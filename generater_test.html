<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Master Generator v68.0 (Integrated Control)</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background: #f0f2f5; padding: 40px; }
        .gen-box { background: #fff; max-width: 900px; margin: 0 auto; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h2 { color: #6c5ce7; border-bottom: 2px solid #6c5ce7; padding-bottom: 10px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9em; color: #444; }
        input, textarea, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; }
        textarea { height: 80px; resize: none; }
        button { width: 100%; padding: 20px; background: #6c5ce7; color: white; border: none; border-radius: 15px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 20px; }
        #outputCode { width: 100%; height: 400px; margin-top: 30px; display: none; font-family: monospace; font-size: 0.8em; background: #2d3436; color: #dfe6e9; }
    </style>
</head>
<body>

<div class="gen-box">
    <h2>ğŸš€ v68.0 í†µí•© ê³¼ì œ ìƒì„±ê¸°</h2>
    <p style="color:#636e72;">ëª¨ë“  ì„¤ì •ê°’ì„ ì…ë ¥í•˜ë©´ <b>ëŒ€ë¬¸/ì‹œí—˜ì§€/ì¹´í†¡ì ê¸ˆ/ì„œë²„ì—°ë™</b>ì´ í¬í•¨ëœ ì „ì²´ ì½”ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤.</p>
    
    <div class="grid">
        <div><label>ê³¼ì œëª…</label><input type="text" id="title" placeholder="ì˜ˆ: 1ì›” 4ì£¼ì°¨ ë§ˆì¹¨ë‚´ ëª¨ì˜ê³ ì‚¬"></div>
        <div><label>GAS ë°°í¬ URL</label><input type="text" id="gasUrl" placeholder="https://script.google.com/macros/s/..."></div>
    </div>

    <div class="grid">
        <div><label>ì‹œì‘ ë‚ ì§œ</label><input type="date" id="startDay"></div>
        <div><label>ì¢…ë£Œ ë‚ ì§œ(ê¸°í•œ)</label><input type="date" id="endDay"></div>
    </div>

    <div class="grid">
        <div><label>ì´ ë¬¸í•­ ìˆ˜</label><input type="number" id="totalQ" value="45"></div>
        <div><label>ì œì™¸í•  ë¬¸í•­ (ì½¤ë§ˆ êµ¬ë¶„)</label><input type="text" id="excludeQ" placeholder="ì˜ˆ: 38,39,40 (ì—†ìœ¼ë©´ ë¹„ì›€)"></div>
    </div>

    <div class="grid">
        <div><label>ë„ì „ ê°€ëŠ¥ íšŸìˆ˜</label><input type="number" id="maxT" value="3"></div>
        <div><label>ì¬ì‘ì‹œ ëŒ€ê¸° ì‹œê°„(ë¶„)</label><input type="number" id="waitMin" value="3"></div>
    </div>

    <div class="grid">
        <div><label>ğŸ“„ ë¬¸ì œì§€ ë§í¬ (ì–¸ë§¤)</label><input type="text" id="pdfUnm"></div>
        <div><label>ğŸ“„ ë¬¸ì œì§€ ë§í¬ (í™”ì‘)</label><input type="text" id="pdfHwj"></div>
    </div>

    <div style="margin-bottom:20px;"><label>ğŸ“– ê³µí†µ í•´ì„¤ì§€ ë§í¬</label><input type="text" id="ansLink"></div>

    <div class="grid">
        <div><label>âœ… ì–¸ë§¤ ì •ë‹µ (ìˆ«ìë§Œ ì­‰)</label><textarea id="ansUnm"></textarea></div>
        <div><label>âœ… í™”ì‘ ì •ë‹µ (ìˆ«ìë§Œ ì­‰)</label><textarea id="ansHwj"></textarea></div>
    </div>

    <div style="margin-bottom:20px;"><label>ğŸ“¢ ëŒ€ë¬¸ ê³µì§€ ë©”ì‹œì§€</label><textarea id="notice"></textarea></div>

    <button onclick="generate()">âœ¨ ì „ì²´ ì½”ë“œ ìƒì„± ë° ë³µì‚¬</button>
    <textarea id="outputCode" readonly></textarea>
</div>

<script>
function generate() {
    const d = {
        title: document.getElementById('title').value,
        gas: document.getElementById('gasUrl').value,
        start: document.getElementById('startDay').value,
        end: document.getElementById('endDay').value,
        total: document.getElementById('totalQ').value,
        exclude: document.getElementById('excludeQ').value,
        maxT: document.getElementById('maxT').value,
        wait: document.getElementById('waitMin').value,
        pdfUnm: document.getElementById('pdfUnm').value,
        pdfHwj: document.getElementById('pdfHwj').value,
        ansLink: document.getElementById('ansLink').value,
        ansUnm: document.getElementById('ansUnm').value,
        ansHwj: document.getElementById('ansHwj').value,
        msg: document.getElementById('notice').value.replace(/\n/g, '<br>')
    };

    const finalHTML = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
    <title>1êµì‹œ ê¹€í˜„ì„ êµ­ì–´</title>
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js"><\/script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        :root { --p: #6c5ce7; --bg: #f8f9fc; --border: #e2e8f0; }
        body { background: var(--bg); font-family: 'Pretendard', sans-serif; margin: 0; padding: 20px; color: #2d3436; -webkit-tap-highlight-color: transparent; }
        .container { max-width: 650px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.03); }
        #introPage { text-align: center; padding: 20px 0; }
        .intro-notice { background: #fff9f0; border: 2px dashed #ffcc80; border-radius: 20px; padding: 25px; margin: 25px 0; text-align: left; }
        .start-btn { width: 100%; padding: 22px; background: var(--p); color: white; border: none; border-radius: 20px; font-size: 1.25em; font-weight: 800; cursor: pointer; }
        #examPage { display: none; }
        .subject-selector { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .sub-btn { padding: 15px; border: 2px solid #eee; border-radius: 12px; background: #fff; font-weight: bold; cursor: pointer; }
        .sub-btn.active { border-color: var(--p); background: #f0edff; color: var(--p); }
        .q-card { border: 1px solid var(--border); border-radius: 20px; padding: 20px; margin-bottom: 15px; }
        .ans-row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        input[type="radio"] { position: absolute; opacity: 0; }
        label { height: 50px; display: flex; align-items: center; justify-content: center; border: 1px solid var(--border); border-radius: 12px; cursor: pointer; font-weight: 700; background: #fff; }
        input[type="radio"]:checked + label { background: var(--p); color: white; border-color: var(--p); }
        #overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 999; align-items: center; justify-content: center; }
        .main-btn { width: 100%; padding: 20px; border: none; border-radius: 15px; font-weight: bold; margin-top: 20px; cursor: pointer; font-size: 1.1rem; }
    </style>
</head>
<body>
<div id="overlay"></div>
<div class="container">
    <div id="introPage">
        <img src="https://saenarachild-crypto.github.io/kim-korean-homework/logo.jpg" style="width:140px; border-radius:25px;">
        <h1>1êµì‹œ ê¹€í˜„ì„ êµ­ì–´</h1>
        <div class="intro-notice"><h3>ğŸ“¢ í•„ìˆ˜ ê³µì§€</h3><p>${d.msg}</p></div>
        <button class="start-btn" onclick="startApp()">í™•ì¸í–ˆìŠµë‹ˆë‹¤. ê³¼ì œ ì‹œì‘!</button>
    </div>
    <div id="examPage">
        <h2 style="text-align:center">${d.title}</h2>
        <div id="timer" style="text-align:right; font-weight:bold; color:#ff6b6b; margin-bottom:10px;">â± <span id="timeText">ìƒíƒœ í™•ì¸ ì¤‘</span></div>
        <div class="subject-selector">
            <button id="btn_unm" class="sub-btn active" onclick="setSubject('unm')">ì–¸ì–´ì™€ ë§¤ì²´</button>
            <button id="btn_hwj" class="sub-btn" onclick="setSubject('hwj')">í™”ë²•ê³¼ ì‘ë¬¸</button>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px">
            <input type="text" id="cN" placeholder="í•™ì›ëª…" style="padding:12px; border:1px solid #ddd; border-radius:10px;">
            <input type="text" id="sN" placeholder="í•™ìƒ ì´ë¦„" style="padding:12px; border:1px solid #ddd; border-radius:10px;">
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px">
            <select id="sD" style="padding:12px; border:1px solid #ddd; border-radius:10px;"></select>
            <a id="paperLink" href="${d.pdfUnm}" target="_blank" style="display:flex;align-items:center;justify-content:center;background:#eee;color:#333;text-decoration:none;border-radius:10px;font-weight:bold;font-size:0.8rem">ğŸ“„ ë¬¸ì œì§€ ë³´ê¸°</a>
        </div>
        <div id="qC"></div>
        <button id="subBtn" class="main-btn" onclick="submit()" style="background:#ff6b6b;color:white;">ğŸ“ ë‹µì•ˆ ì œì¶œí•˜ê¸°</button>
        <button id="kakaoBtn" class="main-btn" onclick="share()" style="display:none;background:#fee500;color:#3c1e1e;">ğŸŸ¡ ì¹´í†¡ìœ¼ë¡œ ì œì¶œ í™•ì¸</button>
        <div id="resArea" style="display:none;margin-top:20px"></div>
    </div>
</div>
<script>
    const C = { title: "${d.title}", start: "${d.start}", end: "${d.end}", max: ${d.maxT}, wait: ${d.wait}, gas: "${d.gas}", ansL: "${d.ansLink}", prefix: "HW_${d.title}_" };
    const PDFS = { unm: "${d.pdfUnm}", hwj: "${d.pdfHwj}" };
    const ANS = { unm: [0, ..."${d.ansUnm}".split("").map(Number)], hwj: [0, ..."${d.ansHwj}".split("").map(Number)] };
    const EXCLUDE = [${d.exclude}];
    let curSub = "unm", w=0, att=0, isPerf=false, resT="", timer=null;

    try { Kakao.init('f81d5eae0eaaf6fa2d0bdccbe6916001'); } catch(e){}

    function startApp() { document.getElementById('introPage').style.display='none'; document.getElementById('examPage').style.display='block'; init(); }
    function setSubject(s) { 
        curSub = s; document.getElementById("btn_unm").className = "sub-btn"+(s==='unm'?' active':'');
        document.getElementById("btn_hwj").className = "sub-btn"+(s==='hwj'?' active':'');
        document.getElementById("paperLink").href = PDFS[s];
        renderQ();
    }
    function init() {
        const sel=document.getElementById("sD"); sel.innerHTML="";
        let loop=new Date(C.start); while(loop <= new Date(C.end)) {
            let s=loop.toISOString().split('T')[0];
            let o=document.createElement("option"); o.value=s; o.innerText=s; sel.appendChild(o);
            loop.setDate(loop.getDate()+1);
        }
        renderQ(); setInterval(updateStatus, 1000);
    }
    function renderQ() {
        let h=""; for(let i=1; i<=${d.total}; i++) {
            if(EXCLUDE.includes(i)) continue;
            h+='<div class="q-card"><b>'+i+'ë²ˆ</b><div class="ans-row">';
            for(let j=1; j<=5; j++) h+='<input type="radio" name="q'+i+'" id="q'+i+'_'+j+'" value="'+j+'"><label for="q'+i+'_'+j+'">'+j+'</label>';
            h+='</div></div>';
        } document.getElementById("qC").innerHTML=h;
    }
    function submit() {
        const cN=document.getElementById("cN").value, sN=document.getElementById("sN").value.trim(), sD=document.getElementById("sD").value;
        if(!cN||!sN||!sD) return alert("ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        w=0; let d=[];
        for(let i=1; i<=${d.total}; i++) {
            if(EXCLUDE.includes(i)) continue;
            let s=document.querySelector('input[name="q'+i+'"]:checked');
            if((s?parseInt(s.value):0) !== ANS[curSub][i]) { w++; d.push(i); }
        }
        isPerf=(w===0); const key="att_"+sN+"_"+C.prefix+curSub; att=parseInt(localStorage.getItem(key)||0)+1;
        localStorage.setItem(key, att); if(isPerf) localStorage.setItem("perf_"+sN+"_"+C.prefix+curSub, "true");
        resT="["+C.title+"] "+sN+"("+att+"íšŒ) ì œì¶œ ì™„ë£Œ";
        document.getElementById("subBtn").style.display="none"; document.getElementById("kakaoBtn").style.display="block";
        fetch(C.gas,{method:"POST",mode:"no-cors",body:JSON.stringify({exam:C.title+"_"+curSub,name:sN,class:cN,attempt:att,wrongCount:w,wrongList:d.join(",")})});
    }
    function share() {
        Kakao.Share.sendDefault({ objectType:"text", text:resT, link:{ mobileWebUrl:window.location.href, webUrl:window.location.href } });
        setTimeout(()=>{
            const o=document.getElementById("overlay"); o.style.display="flex";
            o.innerHTML="<div style='background:white;padding:30px;border-radius:20px;text-align:center;width:80%;max-width:300px'><p>ì¹´í†¡ ì „ì†¡ì„ ì™„ë£Œí•˜ì…¨ë‚˜ìš”?</p><button onclick='done()' style='padding:12px;background:#fee500;border:none;border-radius:10px;font-weight:bold;width:100%'>ë„¤, ì™„ë£Œí–ˆìŠµë‹ˆë‹¤</button></div>";
        },1500);
    }
    function done() {
        document.getElementById("overlay").style.display="none"; document.getElementById("kakaoBtn").style.display="none";
        document.getElementById("resArea").style.display="block";
        document.getElementById("resArea").innerHTML="<div style='padding:25px;background:#eeebff;border-radius:15px;text-align:center'><h3>ì±„ì  ì™„ë£Œ</h3><p>ì˜¤ë‹µ: "+w+"ê°œ</p><a href='"+C.ansL+"' target='_blank' style='display:block;padding:15px;background:#6c5ce7;color:white;text-decoration:none;border-radius:10px;font-weight:bold'>í•´ì„¤ì§€ ë³´ê¸°</a></div>";
    }
    function updateStatus() {
        const sN=document.getElementById("sN").value.trim(); if(!sN) return;
        const now=new Date().getTime(); const end=new Date(C.end); end.setHours(23,59,59,999);
        const disk=document.getElementById("timeText");
        if(now > end.getTime()){ disk.innerText="ê¸°í•œ ë§ˆê°"; document.getElementById("subBtn").disabled=true; }
        else { disk.innerText="ì œì¶œ ê°€ëŠ¥"; document.getElementById("subBtn").disabled=false; }
    }
<\/script>
</body>
</html>`;
    document.getElementById('outputCode').value = finalHTML;
    document.getElementById('outputCode').style.display = 'block';
    alert("ì½”ë“œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤! í•˜ë‹¨ì—ì„œ ë³µì‚¬í•˜ì„¸ìš”.");
}
</script>
</body>
</html>