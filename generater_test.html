<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ğŸ“ ê¹€í˜„ì„ êµ­ì–´ ì˜¬ì¸ì› ìƒì„±ê¸° v75</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            padding: 20px; 
            color: #2d3436; 
            min-height: 100vh; 
        }
        .gen-box { 
            background: #fff; 
            max-width: 1100px; 
            margin: 0 auto; 
            padding: 40px; 
            border-radius: 30px; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.3); 
            animation: slideUp 0.5s ease;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        h1 { 
            color: #667eea; 
            text-align: center; 
            margin: 0 0 10px 0; 
            font-size: 2.2em; 
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .subtitle { 
            text-align: center; 
            color: #7f8c8d; 
            margin-bottom: 30px; 
            font-size: 0.95em;
        }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        .grid3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        label { 
            display: block; 
            font-weight: 600; 
            margin-bottom: 8px; 
            font-size: 0.9em; 
            color: #2d3436; 
        }
        input, textarea, select { 
            width: 100%; 
            padding: 12px 15px; 
            border: 2px solid #e8ecef; 
            border-radius: 12px; 
            box-sizing: border-box; 
            font-size: 0.95em; 
            transition: all 0.3s ease;
            font-family: inherit;
        }
        input:focus, textarea:focus, select:focus { 
            border-color: #667eea; 
            outline: none; 
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        textarea { 
            height: 100px; 
            resize: vertical; 
        }
        .section-title { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 15px 20px; 
            border-radius: 15px; 
            font-weight: 700; 
            margin: 30px 0 20px 0; 
            font-size: 1em;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        button { 
            width: 100%; 
            padding: 22px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            border: none; 
            border-radius: 16px; 
            font-size: 1.3em; 
            font-weight: 700; 
            cursor: pointer; 
            margin-top: 30px; 
            transition: all 0.3s ease; 
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4); 
        }
        button:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5); 
        }
        button:active {
            transform: translateY(-1px);
        }
        #outputCode { 
            width: 100%; 
            height: 500px; 
            margin-top: 30px; 
            display: none; 
            font-family: 'Consolas', 'Monaco', monospace; 
            font-size: 0.8em; 
            background: #2d3436; 
            color: #dfe6e9; 
            padding: 25px; 
            border-radius: 15px; 
            border: none; 
            line-height: 1.6;
        }
        .help-text { 
            font-size: 0.8em; 
            color: #95a5a6; 
            margin-top: 5px; 
        }
        .checkbox-group { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 12px; 
        }
        .checkbox-wrapper { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            padding: 12px 15px; 
            background: #f8f9fa; 
            border-radius: 10px; 
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        .checkbox-wrapper:hover {
            background: #e9ecef;
            border-color: #667eea;
        }
        .checkbox-wrapper input[type="checkbox"] { 
            width: auto; 
            margin: 0; 
            cursor: pointer;
            transform: scale(1.2);
        }
        .checkbox-wrapper label { 
            margin: 0; 
            font-size: 0.9em; 
            cursor: pointer;
            font-weight: 500;
        }
        .mode-selector { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 15px; 
            margin-bottom: 25px; 
        }
        .mode-btn { 
            padding: 20px; 
            border: 3px solid #e8ecef; 
            border-radius: 15px; 
            background: #fff; 
            cursor: pointer; 
            text-align: center; 
            font-weight: 700; 
            transition: all 0.3s ease;
        }
        .mode-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }
        .mode-btn.active { 
            border-color: #667eea; 
            background: linear-gradient(135deg, #f0f3ff 0%, #e8edff 100%); 
            color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        .dual-section { display: none; }
        .dual-section.active { display: block; }
        .type-box {
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        .type-box h4 {
            margin: 0 0 15px 0;
            font-size: 1.1em;
        }
        .type-a { background: linear-gradient(135deg, #e8f5e9 0%, #f1f8f2 100%); }
        .type-a h4 { color: #2e7d32; }
        .type-b { background: linear-gradient(135deg, #fff3e0 0%, #fff8f0 100%); }
        .type-b h4 { color: #e65100; }
    </style>
</head>
<body>

<div class="gen-box">
    <h1>ğŸ“ ê¹€í˜„ì„ êµ­ì–´ ì˜¬ì¸ì› ìƒì„±ê¸°</h1>
    <p class="subtitle">v75 - ê³µì§€ì‚¬í•­ í‘œì‹œ + ëŒ€ê¸°ì‹œê°„ íƒ€ì´ë¨¸ ìˆ˜ì • + ë””ìì¸ ì¼ê´€ì„± ê°œì„ </p>
    
    <div class="section-title">ğŸ“Œ 1. ì‹œí—˜ ëª¨ë“œ ì„ íƒ</div>
    <div class="mode-selector">
        <div class="mode-btn active" onclick="setMode('single')">
            <div style="font-size:2.5em; margin-bottom:8px">ğŸ“„</div>
            <div style="font-size:1.1em">ë‹¨ì¼ íƒ€ì…</div>
            <div style="font-size:0.85em; color:#7f8c8d; margin-top:8px">ë…ì„œ ë˜ëŠ” ë¬¸í•™ í•˜ë‚˜ë§Œ</div>
        </div>
        <div class="mode-btn" onclick="setMode('dual')">
            <div style="font-size:2.5em; margin-bottom:8px">ğŸ“š</div>
            <div style="font-size:1.1em">ë“€ì–¼ íƒ€ì…</div>
            <div style="font-size:0.85em; color:#7f8c8d; margin-top:8px">ë…ì„œ/ë¬¸í•™ ë˜ëŠ” ì–¸ë§¤/í™”ì‘</div>
        </div>
    </div>

    <div class="section-title">ğŸ“ 2. ê¸°ë³¸ ì •ë³´</div>
    <div class="grid">
        <div>
            <label>ê³¼ì œ ëŒ€ë¶„ë¥˜</label>
            <select id="category">
                <option value="ì£¼ê°„ ê³¼ì œ">ì£¼ê°„ ê³¼ì œ</option>
                <option value="ë§ˆì¹¨ë‚´ ëª¨ì˜ê³ ì‚¬">ë§ˆì¹¨ë‚´ ëª¨ì˜ê³ ì‚¬</option>
                <option value="ìˆ˜ì—… í™•ì¸ í…ŒìŠ¤íŠ¸">ìˆ˜ì—… í™•ì¸ í…ŒìŠ¤íŠ¸</option>
                <option value="ê¸°íƒ€ ì‹œí—˜">ê¸°íƒ€ ì‹œí—˜</option>
            </select>
        </div>
        <div><label>ìƒì„¸ ëª…ì¹­</label><input type="text" id="subTitle" placeholder="ì˜ˆ: 2ì›” 3íšŒì°¨"></div>
    </div>
    <div class="grid">
        <div><label>ì‹œì‘ ë‚ ì§œ</label><input type="date" id="startDay"></div>
        <div><label>ì¢…ë£Œ ë‚ ì§œ</label><input type="date" id="endDay"></div>
    </div>

    <div class="section-title">ğŸ¯ 3. ì‘ì‹œ ì„¤ì •</div>
    <div class="grid3">
        <div><label>ìµœëŒ€ ë„ì „ íšŸìˆ˜</label><input type="number" id="maxT" value="3"></div>
        <div><label>ì¬ì‘ì‹œ ëŒ€ê¸°(ë¶„)</label><input type="number" id="waitMin" value="3"></div>
        <div>
            <label>íŒíŠ¸ ì œê³µ ë°©ì‹</label>
            <select id="hintMode">
                <option value="from2">2íšŒì°¨ë¶€í„° ê³µê°œ</option>
                <option value="last">ë§ˆì§€ë§‰ íšŒì°¨ë§Œ</option>
                <option value="never">ì œê³µ ì•ˆ í•¨</option>
            </select>
        </div>
    </div>

    <!-- ë‹¨ì¼ íƒ€ì… ì„¤ì • -->
    <div id="singleSection">
        <div class="section-title">ğŸ“„ 4. ë‹¨ì¼ íƒ€ì… ì„¤ì •</div>
        <div class="grid">
            <div><label>ì´ ë¬¸í•­ ìˆ˜</label><input type="number" id="totalQ_S" value="33"></div>
            <div>
                <label>í™œì„± ë¬¸í•­ ë²ˆí˜¸ (ì‰¼í‘œ êµ¬ë¶„, ë¹„ìš°ë©´ ì „ì²´)</label>
                <input type="text" id="activeList_S" placeholder="ì˜ˆ: 5,6,7,8,13-16,21-24">
                <div class="help-text">â€» ë²”ìœ„ í‘œê¸° ê°€ëŠ¥: 13-16 â†’ 13,14,15,16</div>
            </div>
        </div>
        <div class="grid">
            <div>
                <label>ì •ë‹µ (ìˆ«ìë§Œ ì—°ì† ì…ë ¥)</label>
                <textarea id="ans_S" placeholder="414434455141123354..."></textarea>
            </div>
            <div>
                <label>ë¬¸ì œì§€ ë§í¬</label>
                <input type="text" id="pdf_S" placeholder="https://...">
            </div>
        </div>
    </div>

    <!-- ë“€ì–¼ íƒ€ì… ì„¤ì • -->
    <div id="dualSection" class="dual-section">
        <div class="section-title">ğŸ“š 4. ë“€ì–¼ íƒ€ì… ì„¤ì •</div>
        
        <div class="type-box type-a">
            <h4>íƒ€ì… A (ë…ì„œ/ì–¸ë§¤)</h4>
            <div class="grid">
                <div><label>ì´ ë¬¸í•­ ìˆ˜</label><input type="number" id="totalQ_A" value="32"></div>
                <div>
                    <label>í™œì„± ë¬¸í•­ ë²ˆí˜¸ (ë¹„ìš°ë©´ ì „ì²´)</label>
                    <input type="text" id="activeList_A" placeholder="ì˜ˆ: 1-32 ë˜ëŠ” 5,6,7,8">
                </div>
            </div>
            <div class="grid">
                <div>
                    <label>ì •ë‹µ</label>
                    <textarea id="ans_A"></textarea>
                </div>
                <div>
                    <label>ë¬¸ì œì§€ ë§í¬</label>
                    <input type="text" id="pdf_A">
                </div>
            </div>
        </div>

        <div class="type-box type-b">
            <h4>íƒ€ì… B (ë¬¸í•™/í™”ì‘)</h4>
            <div class="grid">
                <div><label>ì´ ë¬¸í•­ ìˆ˜</label><input type="number" id="totalQ_B" value="32"></div>
                <div>
                    <label>í™œì„± ë¬¸í•­ ë²ˆí˜¸ (ë¹„ìš°ë©´ ì „ì²´)</label>
                    <input type="text" id="activeList_B" placeholder="ì˜ˆ: 1-32 ë˜ëŠ” 9-16">
                </div>
            </div>
            <div class="grid">
                <div>
                    <label>ì •ë‹µ</label>
                    <textarea id="ans_B"></textarea>
                </div>
                <div>
                    <label>ë¬¸ì œì§€ ë§í¬</label>
                    <input type="text" id="pdf_B">
                </div>
            </div>
        </div>
    </div>

    <div class="section-title">ğŸ“– 5. ë§í¬ ë° ê³µì§€</div>
    <div>
        <label>í•´ì„¤ì§€ ë§í¬</label>
        <input type="text" id="ansLink" placeholder="https://...">
    </div>
    <div style="margin-top:15px">
        <label>í•™ìƒ ê³µì§€ ë‚´ìš©</label>
        <textarea id="notice" placeholder="ê³¼ì œ ì•ˆë‚´ ë° ì£¼ì˜ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
    </div>

    <div class="section-title">âš™ï¸ 6. ê³ ê¸‰ ê¸°ëŠ¥</div>
    <div class="checkbox-group">
        <div class="checkbox-wrapper">
            <input type="checkbox" id="enableTimer" checked>
            <label for="enableTimer">â± ëŒ€ê¸° íƒ€ì´ë¨¸ í‘œì‹œ</label>
        </div>
        <div class="checkbox-wrapper">
            <input type="checkbox" id="enablePerfect" checked>
            <label for="enablePerfect">ğŸ¯ ë§Œì  ë‹¬ì„± ì‹œ ìë™ ì¢…ë£Œ</label>
        </div>
        <div class="checkbox-wrapper">
            <input type="checkbox" id="enableAdminView" checked>
            <label for="enableAdminView">ğŸ“Š Admin View ì„±ì  í™•ì¸</label>
        </div>
        <div class="checkbox-wrapper">
            <input type="checkbox" id="compactMode">
            <label for="compactMode">ğŸ“± ì••ì¶• ëª¨ë“œ (íŒŒì¼ í¬ê¸° ìµœì†Œí™”)</label>
        </div>
    </div>

    <div class="section-title">ğŸ”§ 7. ì‹œìŠ¤í…œ ì„¤ì •</div>
    <div class="grid">
        <div><label>GAS URL</label><input type="text" id="gasUrl" value="https://script.google.com/macros/s/AKfycbzkA0CC8GAhcdAP16fzq32ufyTIYolZ8TyeuSjW5FAsG0M3vPcYQOIaSKIOOYKYgtDc/exec"></div>
        <div><label>Kakao API Key</label><input type="text" id="kakaoKey" value="f81d5eae0eaaf6fa2d0bdccbe6916001"></div>
    </div>
    <div>
        <label>Admin Base URL (ì„±ì  í™•ì¸ìš©)</label>
        <input type="text" id="adminBase" placeholder="ì˜ˆ: https://saenarachild-crypto.github.io/kim-korean-homework/hw_xxxx.html">
    </div>

    <button onclick="generate()">âœ¨ ì™„ì„±ëœ HTML ìƒì„±í•˜ê¸°</button>
    <textarea id="outputCode" readonly></textarea>
</div>

<script>
let currentMode = 'single';

function setMode(mode) {
    currentMode = mode;
    document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
    event.target.closest('.mode-btn').classList.add('active');
    
    if (mode === 'single') {
        document.getElementById('singleSection').style.display = 'block';
        document.getElementById('dualSection').classList.remove('active');
    } else {
        document.getElementById('singleSection').style.display = 'none';
        document.getElementById('dualSection').classList.add('active');
    }
}

function parseActiveList(input) {
    if (!input.trim()) return null;
    const result = [];
    input.split(',').forEach(part => {
        part = part.trim();
        if (part.includes('-')) {
            const [start, end] = part.split('-').map(n => parseInt(n.trim()));
            for (let i = start; i <= end; i++) result.push(i);
        } else {
            result.push(parseInt(part));
        }
    });
    return [...new Set(result)].sort((a, b) => a - b);
}

function generate() {
    const category = document.getElementById('category').value;
    const subTitle = document.getElementById('subTitle').value.trim();
    const startDay = document.getElementById('startDay').value;
    const endDay = document.getElementById('endDay').value;
    const maxT = document.getElementById('maxT').value;
    const waitMin = document.getElementById('waitMin').value;
    const hintMode = document.getElementById('hintMode').value;
    const ansLink = document.getElementById('ansLink').value.trim();
    const notice = document.getElementById('notice').value.replace(/\n/g, '<br>');
    const adminBase = document.getElementById('adminBase').value.trim();
    const gasUrl = document.getElementById('gasUrl').value.trim();
    const kakaoKey = document.getElementById('kakaoKey').value.trim();
    
    const enableTimer = document.getElementById('enableTimer').checked;
    const enablePerfect = document.getElementById('enablePerfect').checked;
    const enableAdminView = document.getElementById('enableAdminView').checked;
    const compactMode = document.getElementById('compactMode').checked;

    if (!subTitle || !startDay || !endDay) {
        alert('í•„ìˆ˜ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
        return;
    }

    const title = category + " " + subTitle;
    const hwId = "HW_" + title.replace(/\s+/g, '');
    
    let htmlContent = '';
    
    if (currentMode === 'single') {
        const totalQ = parseInt(document.getElementById('totalQ_S').value);
        const activeInput = document.getElementById('activeList_S').value;
        const ans = document.getElementById('ans_S').value.replace(/[^0-9]/g, '');
        const pdf = document.getElementById('pdf_S').value.trim();
        
        if (ans.length !== totalQ) {
            alert('ì •ë‹µ ê°œìˆ˜(' + ans.length + ')ì™€ ì´ ë¬¸í•­ ìˆ˜(' + totalQ + ')ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            return;
        }
        
        const activeList = parseActiveList(activeInput) || Array.from({length: totalQ}, (_, i) => i + 1);
        
        htmlContent = generateSingleHTML({
            title, hwId, startDay, endDay, maxT, waitMin, hintMode,
            totalQ, activeList, ans, pdf, ansLink, notice, adminBase, gasUrl, kakaoKey,
            enableTimer, enablePerfect, enableAdminView, compactMode
        });
        
    } else {
        const totalQ_A = parseInt(document.getElementById('totalQ_A').value);
        const totalQ_B = parseInt(document.getElementById('totalQ_B').value);
        const activeInput_A = document.getElementById('activeList_A').value;
        const activeInput_B = document.getElementById('activeList_B').value;
        const ans_A = document.getElementById('ans_A').value.replace(/[^0-9]/g, '');
        const ans_B = document.getElementById('ans_B').value.replace(/[^0-9]/g, '');
        const pdf_A = document.getElementById('pdf_A').value.trim();
        const pdf_B = document.getElementById('pdf_B').value.trim();
        
        if (ans_A.length !== totalQ_A) {
            alert('íƒ€ì… A ì •ë‹µ ê°œìˆ˜(' + ans_A.length + ')ì™€ ì´ ë¬¸í•­ ìˆ˜(' + totalQ_A + ')ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            return;
        }
        if (ans_B.length !== totalQ_B) {
            alert('íƒ€ì… B ì •ë‹µ ê°œìˆ˜(' + ans_B.length + ')ì™€ ì´ ë¬¸í•­ ìˆ˜(' + totalQ_B + ')ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            return;
        }
        
        const activeList_A = parseActiveList(activeInput_A) || Array.from({length: totalQ_A}, (_, i) => i + 1);
        const activeList_B = parseActiveList(activeInput_B) || Array.from({length: totalQ_B}, (_, i) => i + 1);
        
        const typeAName = category === 'ë§ˆì¹¨ë‚´ ëª¨ì˜ê³ ì‚¬' ? 'ì–¸ì–´ì™€ ë§¤ì²´' : 'ë…ì„œ';
        const typeBName = category === 'ë§ˆì¹¨ë‚´ ëª¨ì˜ê³ ì‚¬' ? 'í™”ë²•ê³¼ ì‘ë¬¸' : 'ë¬¸í•™';
        
        htmlContent = generateDualHTML({
            title, hwId, startDay, endDay, maxT, waitMin, hintMode,
            totalQ_A, totalQ_B, activeList_A, activeList_B,
            ans_A, ans_B, pdf_A, pdf_B, ansLink, notice, adminBase, gasUrl, kakaoKey,
            typeAName, typeBName,
            enableTimer, enablePerfect, enableAdminView, compactMode
        });
    }
    
    document.getElementById('outputCode').value = htmlContent;
    document.getElementById('outputCode').style.display = 'block';
    document.getElementById('outputCode').select();
    
    alert('âœ… ' + (currentMode === 'single' ? 'ë‹¨ì¼' : 'ë“€ì–¼') + ' íƒ€ì… HTML ìƒì„± ì™„ë£Œ!\n\nğŸ”§ ì£¼ìš” ìˆ˜ì •ì‚¬í•­:\nâ€¢ ê³µì§€ì‚¬í•­ í‘œì‹œ ë¬¸ì œ í•´ê²°\nâ€¢ ëŒ€ê¸° íƒ€ì´ë¨¸ ì •ìƒ ì‘ë™\nâ€¢ ë””ìì¸ ì¼ê´€ì„± ê°œì„ \n\ní™œì„± ê¸°ëŠ¥:\nâ€¢ ' + (enableTimer ? 'ëŒ€ê¸° íƒ€ì´ë¨¸ âœ“' : 'ëŒ€ê¸° íƒ€ì´ë¨¸ âœ—') + '\nâ€¢ ' + (enablePerfect ? 'ë§Œì  ì¶”ì  âœ“' : 'ë§Œì  ì¶”ì  âœ—') + '\nâ€¢ ' + (enableAdminView ? 'Admin View âœ“' : 'Admin View âœ—'));
}

// ë‹¨ì¼ íƒ€ì… HTML ìƒì„± í•¨ìˆ˜
function generateSingleHTML(config) {
    let hintLogic = '""';
    if (config.hintMode === 'last') {
        hintLogic = '(att === maxT ? "\\nğŸ“ í‹€ë¦° ë²ˆí˜¸: " + wrongListStr : "")';
    } else if (config.hintMode === 'from2') {
        hintLogic = '(att >= 2 ? "\\nğŸ“ í‹€ë¦° ë²ˆí˜¸: " + wrongListStr : "")';
    }
    
    const adminViewCode = config.enableAdminView ? 
`window.addEventListener('DOMContentLoaded',function(){const p=new URLSearchParams(window.location.search);if(p.has("admin_view")){try{const d=JSON.parse(decodeURIComponent(p.get("admin_view")));document.body.innerHTML='<div class="container" style="margin-top:50px;text-align:center;box-shadow:0 0 100px rgba(0,0,0,0.2);border:3px solid #667eea"><h2 style="color:#667eea;margin-bottom:20px">ğŸ“Š ì„±ì  í™•ì¸</h2><div style="background:#f8f9fa;padding:20px;border-radius:12px;margin:20px;text-align:left;font-size:1.1rem;line-height:2"><b>ğŸ‘¤ ì´ë¦„:</b> '+d.name+'<br><b>ğŸ« í•™ì›:</b> '+d.class+'<br><b>ğŸ”„ ë„ì „:</b> '+d.att+'íšŒì°¨<br><b>âŒ ì˜¤ë‹µ:</b> <span style="color:#e74c3c;font-weight:bold">'+d.wrongCount+'ê°œ</span><br><b>ğŸ“ ë²ˆí˜¸:</b> '+(d.wrongList||"ì—†ìŒ")+'</div><button onclick="location.href=location.href.split(\\'?\\')[0]" style="width:90%;padding:15px;background:#667eea;color:white;border:none;border-radius:10px;font-weight:bold;cursor:pointer;font-size:1.1em">ëŒì•„ê°€ê¸°</button></div>';return}catch(e){console.error('Admin view parse error:',e)}}initPage()});` :
'window.addEventListener(\'DOMContentLoaded\',initPage);';

    const timerHTML = config.enableTimer ? '<div id="timer" style="text-align:right;font-weight:bold;color:#e74c3c;margin-bottom:15px;font-size:1.05em">â± <span id="timeText">ì…ë ¥ ê°€ëŠ¥</span></div>' : '';
    
    const timerFunction = config.enableTimer ?
`function startWaitTimer(){if(timerInterval)clearInterval(timerInterval);timeLeft=waitMin*60;const btn=document.getElementById("subBtn");const timeText=document.getElementById("timeText");btn.style.opacity="0.5";btn.innerText="â± ëŒ€ê¸° ì¤‘...";btn.disabled=true;timerInterval=setInterval(()=>{if(timeLeft<=0){clearInterval(timerInterval);timerInterval=null;btn.style.opacity="1";btn.innerText="ğŸ“ ë‹µì•ˆ ì œì¶œí•˜ê¸°";btn.disabled=false;timeText.innerText="ì…ë ¥ ê°€ëŠ¥";return}timeLeft--;const m=Math.floor(timeLeft/60),s=timeLeft%60;timeText.innerText="ë‹¤ìŒ ë„ì „ê¹Œì§€ "+m+"ë¶„ "+(s<10?"0"+s:s)+"ì´ˆ";},1000)}` :
`function startWaitTimer(){setTimeout(()=>{alert("${config.waitMin}ë¶„ í›„ì— ë‹¤ì‹œ ë„ì „í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");document.getElementById("subBtn").disabled=false;document.getElementById("subBtn").innerText="ğŸ“ ë‹µì•ˆ ì œì¶œí•˜ê¸°"},100)}`;

    const perfectCheckCode = config.enablePerfect ? 
'if(isPerfect)localStorage.setItem("perf_"+sN+"_"+HW_ID,"true");' : '';

    const perfectCheckLimit = config.enablePerfect ?
'if(localStorage.getItem("perf_"+sN+"_"+HW_ID)==="true"){isBlocked=true;showFinalResult("ë°±ì  ë‹¬ì„±!");return}' : '';

    const perfectCheckDone = config.enablePerfect ?
'if(isPerfect){showFinalResult("ë°±ì  ë‹¬ì„±!");return}' : '';

    return `<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>${config.title}</title>
<script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js" crossorigin="anonymous"><\/script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:20px;margin:0;min-height:100vh}
.container{max-width:650px;margin:0 auto;background:#fff;padding:35px;border-radius:25px;box-shadow:0 20px 60px rgba(0,0,0,0.15);animation:slideIn 0.4s ease}
@keyframes slideIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
h2{text-align:center;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:15px;font-size:1.8em;font-weight:800}
.notice-box{background:linear-gradient(135deg,#fff3e0 0%,#ffe4b5 100%);padding:20px;border-radius:15px;margin-bottom:25px;font-size:0.95rem;color:#5d4037;line-height:1.8;border-left:5px solid #ff9800}
.notice-box b{color:#e65100}
.q-card{background:#fff;border:2px solid #f1f3f5;border-radius:18px;padding:22px;margin-bottom:15px;transition:all 0.3s ease;box-shadow:0 2px 8px rgba(0,0,0,0.04)}
.q-card:hover{border-color:#667eea;box-shadow:0 4px 15px rgba(102,126,234,0.15)}
.q-num{font-weight:bold;margin-bottom:15px;font-size:1.15em;color:#2d3436}
.options{display:grid;grid-template-columns:repeat(5,1fr);gap:10px}
.opt-input{position:absolute;width:0;height:0;opacity:0;pointer-events:none}
.opt-label{height:50px;border:2px solid #e9ecef;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:700;cursor:pointer;transition:all 0.2s ease;background:#fff;font-size:1.05em}
.opt-label:hover{border-color:#667eea;transform:translateY(-2px);box-shadow:0 4px 12px rgba(102,126,234,0.2)}
.opt-input:checked+.opt-label{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border-color:transparent;box-shadow:0 5px 15px rgba(102,126,234,0.4)}
.opt-input:disabled+.opt-label{background:#e9ecef;color:#adb5bd;cursor:not-allowed;border-color:#dee2e6}
.opt-input:disabled+.opt-label:hover{transform:none;box-shadow:none}
#limitMsg{display:none;color:#fff;font-weight:bold;text-align:center;margin-bottom:20px;padding:18px;background:linear-gradient(135deg,#ff6b6b 0%,#ee5a6f 100%);border-radius:15px;font-size:1.05em;box-shadow:0 4px 15px rgba(255,107,107,0.3)}
#overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:999;align-items:center;justify-content:center}
.overlay-content{background:#fff;padding:35px;border-radius:20px;text-align:center;max-width:90%;width:350px;box-shadow:0 20px 60px rgba(0,0,0,0.3);animation:popIn 0.3s ease}
@keyframes popIn{from{opacity:0;transform:scale(0.9)}to{opacity:1;transform:scale(1)}}
.overlay-content p{font-weight:600;font-size:1.1em;margin-bottom:20px;color:#2d3436}
input,select{padding:14px 16px;border:2px solid#e9ecef;border-radius:12px;width:100%;box-sizing:border-box;outline:none;font-size:0.95em;transition:all 0.2s ease;font-family:inherit}
input:focus,select:focus{border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.1)}
.input-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:15px}
.btn{width:100%;padding:18px;border:none;border-radius:15px;font-weight:700;cursor:pointer;font-size:1.1em;transition:all 0.3s ease}
.btn-primary{background:linear-gradient(135deg,#ff6b6b 0%,#ee5a6f 100%);color:#fff;box-shadow:0 5px 20px rgba(255,107,107,0.4)}
.btn-primary:hover{transform:translateY(-3px);box-shadow:0 8px 25px rgba(255,107,107,0.5)}
.btn-primary:disabled{opacity:0.5;cursor:not-allowed;transform:none}
.btn-kakao{background:#FEE500;color:#3c1e1e;box-shadow:0 5px 20px rgba(254,229,0,0.3)}
.btn-kakao:hover{transform:translateY(-3px);box-shadow:0 8px 25px rgba(254,229,0,0.4)}
.btn-confirm{background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff}
.btn-confirm:hover{transform:scale(1.02)}
.link-btn{display:flex;align-items:center;justify-content:center;background:#e9ecef;color:#2d3436;text-decoration:none;border-radius:12px;font-weight:700;font-size:0.9em;padding:14px;transition:all 0.2s ease}
.link-btn:hover{background:#dee2e6;transform:translateY(-2px)}
#resArea{margin-top:25px}
.result-box{padding:30px;background:linear-gradient(135deg,#f0edff 0%,#e8e4ff 100%);border-radius:18px;text-align:center;border:3px solid #667eea}
.result-box h3{color:#667eea;margin-bottom:15px;font-size:1.5em}
.result-box p{line-height:1.8;font-size:1.05em;color:#2d3436}
.result-link{display:block;padding:16px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;text-decoration:none;border-radius:12px;font-weight:700;margin-top:15px;transition:all 0.3s ease}
.result-link:hover{transform:translateY(-2px);box-shadow:0 5px 20px rgba(102,126,234,0.4)}
</style>
<script>${adminViewCode}<\/script>
</head>
<body>
<div id="overlay"></div>
<div class="container">
<h2>${config.title}</h2>
${timerHTML}
<div class="notice-box"><b>ğŸ“¢ ê³µì§€ì‚¬í•­</b><br>${config.notice}<br><br>ğŸ“… ê¸°í•œ: ${config.startDay} ~ ${config.endDay}<br>ğŸ”„ ì´ ${config.maxT}íšŒ ë„ì „ ê°€ëŠ¥${config.enableTimer ? '<br>â± ì¬ë„ì „ ëŒ€ê¸°ì‹œê°„: ' + config.waitMin + 'ë¶„' : ''}</div>
<div id="limitMsg"></div>
<div class="input-grid">
<input type="text" id="cN" placeholder="í•™ì›ëª… ì…ë ¥">
<input type="text" id="sN" placeholder="í•™ìƒ ì´ë¦„ ì…ë ¥" oninput="checkLimit()">
</div>
<div class="input-grid">
<select id="sD" onchange="checkLimit()"><option value="">ì œì¶œì¼ ì„ íƒ</option></select>
<a href="${config.pdf}" target="_blank" class="link-btn">ğŸ“„ ë¬¸ì œì§€ ë³´ê¸°</a>
</div>
<div id="qC"></div>
<button id="subBtn" class="btn btn-primary" onclick="submit()">ğŸ“ ë‹µì•ˆ ì œì¶œí•˜ê¸°</button>
<button id="kakaoBtn" class="btn btn-kakao" onclick="share()" style="display:none;margin-top:15px">ğŸŸ¡ ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì œì¶œ í™•ì¸</button>
<div id="resArea" style="display:none"></div>
</div>
<script>
let timeLeft=0,timerInterval=null,w=0,att=0,isBlocked=false,resT="",isPerfect=false,wrongListStr="";
const masterAnswers=[0,${config.ans.split('').join(',')}];
const activeList=[${config.activeList.join(',')}];
const totalQ=${config.totalQ},maxT=${config.maxT},waitMin=${config.waitMin};
const startDay="${config.startDay}",endDay="${config.endDay}";
const ansLink="${config.ansLink}",HW_ID="${config.hwId}";
let kakaoInitialized=false;
function initKakao(){if(kakaoInitialized)return;try{if(typeof Kakao!=='undefined'&&!Kakao.isInitialized()){Kakao.init("${config.kakaoKey}");kakaoInitialized=true}}catch(e){console.error('Kakao init:',e)}}
setTimeout(initKakao,100);
function initPage(){const sel=document.getElementById("sD");const now=new Date();now.setHours(0,0,0,0);const end=new Date(endDay);end.setHours(23,59,59,999);let loopDate=new Date(startDay);while(loopDate<=end){let s=loopDate.getFullYear()+"-"+String(loopDate.getMonth()+1).padStart(2,'0')+"-"+String(loopDate.getDate()).padStart(2,'0');let opt=document.createElement("option");opt.value=s;opt.innerText=s;sel.appendChild(opt);loopDate.setDate(loopDate.getDate()+1)}let h="";for(let n=1;n<=totalQ;n++){const dis=activeList.includes(n)?"":"disabled";h+='<div class="q-card"><div class="q-num">'+n+'ë²ˆ</div><div class="options">';for(let j=1;j<=5;j++){h+='<input type="radio" name="q'+n+'" id="q'+n+'_'+j+'" value="'+j+'" class="opt-input" '+dis+'><label for="q'+n+'_'+j+'" class="opt-label">'+j+'</label>'}h+='</div></div>'}document.getElementById("qC").innerHTML=h;checkDateLimit()}
function submit(){if(isBlocked){alert('ì œì¶œì´ ë¶ˆê°€ëŠ¥í•œ ìƒíƒœì…ë‹ˆë‹¤.');return}const cN=document.getElementById("cN").value.trim(),sN=document.getElementById("sN").value.trim().replace(/\\s/g,""),sD=document.getElementById("sD").value;if(!cN||!sN||!sD){alert("í•™ì›ëª…, í•™ìƒ ì´ë¦„, ì œì¶œì¼ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}w=0;let d=[];activeList.forEach(qNum=>{let s=document.querySelector("input[name='q"+qNum+"']:checked");let v=s?parseInt(s.value):0;if(v!==masterAnswers[qNum]){w++;d.push(qNum)}});isPerfect=(w===0);wrongListStr=d.join(",");const key="att_"+sN+"_"+HW_ID;att=parseInt(localStorage.getItem(key)||0)+1;localStorage.setItem(key,att);${perfectCheckCode}resT="[${config.title}]\\n"+sN+"("+att+"íšŒì°¨) ì œì¶œ ì™„ë£Œ\\nì˜¤ë‹µ: "+w+"ê°œ";document.getElementById("subBtn").style.display="none";document.getElementById("kakaoBtn").style.display="block";fetch("${config.gasUrl}",{method:"POST",mode:"no-cors",headers:{'Content-Type':'application/json'},body:JSON.stringify({exam:"${config.title}",name:sN,class:cN,attempt:att,wrongCount:w,wrongList:wrongListStr,submitDate:sD})}).catch(err=>console.error('Submit:',err))}
function checkDateLimit(){const now=new Date();now.setHours(0,0,0,0);const sDate=new Date(startDay);sDate.setHours(0,0,0,0);const eDate=new Date(endDay);eDate.setHours(23,59,59,999);const msg=document.getElementById("limitMsg");const btn=document.getElementById("subBtn");if(now<sDate){isBlocked=true;btn.style.display="none";msg.style.display="block";msg.innerText="â³ ì•„ì§ ì œì¶œ ê¸°ê°„ì´ ì•„ë‹™ë‹ˆë‹¤."}else if(now>eDate){isBlocked=true;btn.style.display="none";msg.style.display="block";msg.innerText="ğŸš« ì œì¶œ ê¸°í•œì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤."}else{msg.style.display="none"}}
function checkLimit(){if(isBlocked)return;const sN=document.getElementById("sN").value.trim().replace(/\\s/g,""),sD=document.getElementById("sD").value;if(sN.length<2||!sD){document.getElementById("subBtn").style.display="block";return}const key="att_"+sN+"_"+HW_ID;att=parseInt(localStorage.getItem(key)||0);${perfectCheckLimit}if(maxT>0&&att>=maxT){isBlocked=true;document.getElementById("subBtn").style.display="none";document.getElementById("limitMsg").style.display="block";document.getElementById("limitMsg").innerText="ğŸš« ëª¨ë“  ë„ì „ ê¸°íšŒë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.";showFinalResult("ê¸°íšŒ ì†Œì§„")}}
${timerFunction}
function done(){document.getElementById("overlay").style.display="none";document.getElementById("kakaoBtn").style.display="none";${perfectCheckDone}if(att>=maxT){showFinalResult("ê¸°íšŒ ì†Œì§„");return}alert("ğŸ“Š "+att+"íšŒì°¨ ê²°ê³¼\\nì˜¤ë‹µ: "+w+"ê°œ"+${hintLogic});document.querySelectorAll(".opt-input").forEach(rb=>{if(!rb.disabled)rb.checked=false});document.getElementById("subBtn").style.display="block";startWaitTimer()}
function showFinalResult(msg){const r=document.getElementById("resArea");r.style.display="block";r.innerHTML='<div class="result-box"><h3>ğŸ '+msg+'</h3><p>ëª¨ë“  ë„ì „ì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.</p><a href="'+ansLink+'" target="_blank" class="result-link">ğŸ“˜ í•´ì„¤ì§€ ë³´ê¸°</a></div>';document.getElementById("subBtn").style.display="none"}
function share(){initKakao();if(!kakaoInitialized||typeof Kakao==='undefined'||!Kakao.Share){alert('ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\nì œì¶œì€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');done();return}try{Kakao.Share.sendDefault({objectType:"text",text:resT,link:{mobileWebUrl:window.location.href,webUrl:window.location.href}});setTimeout(()=>{const o=document.getElementById("overlay");o.style.display="flex";o.innerHTML='<div class="overlay-content"><p>ğŸ“± ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì „ì†¡í•˜ì…¨ë‚˜ìš”?</p><button onclick="done()" class="btn btn-confirm">ë„¤, ì™„ë£Œí–ˆìŠµë‹ˆë‹¤</button></div>'},1500)}catch(e){console.error('Kakao:',e);alert('ì¹´ì¹´ì˜¤í†¡ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\\nì œì¶œì€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');done()}}
<\/script>
</body>
</html>`;
}

// ë“€ì–¼ íƒ€ì… HTML ìƒì„± í•¨ìˆ˜
function generateDualHTML(config) {
    let hintLogic = '""';
    if (config.hintMode === 'last') {
        hintLogic = '(att===maxT?"\\nğŸ“ í‹€ë¦° ë²ˆí˜¸: "+wrongListStr:"")';
    } else if (config.hintMode === 'from2') {
        hintLogic = '(att>=2?"\\nğŸ“ í‹€ë¦° ë²ˆí˜¸: "+wrongListStr:"")';
    }
    
    const adminViewCode = config.enableAdminView ?
`window.addEventListener('DOMContentLoaded',function(){const p=new URLSearchParams(window.location.search);if(p.has("admin_view")){try{const d=JSON.parse(decodeURIComponent(p.get("admin_view")));document.body.innerHTML='<div class="container" style="margin-top:50px;text-align:center;box-shadow:0 0 100px rgba(0,0,0,0.2);border:3px solid #667eea"><h2 style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:20px">ğŸ“Š ì„±ì  í™•ì¸</h2><div style="background:#f8f9fa;padding:20px;border-radius:12px;margin:20px;text-align:left;font-size:1.1rem;line-height:2"><b>ğŸ‘¤ ì´ë¦„:</b> '+d.name+'<br><b>ğŸ« í•™ì›:</b> '+d.class+'<br><b>ğŸ“ íƒ€ì…:</b> '+d.type+'<br><b>ğŸ”„ ë„ì „:</b> '+d.att+'íšŒì°¨<br><b>âŒ ì˜¤ë‹µ:</b> <span style="color:#e74c3c;font-weight:bold">'+d.wrongCount+'ê°œ</span><br><b>ğŸ“ ë²ˆí˜¸:</b> '+(d.wrongList||"ì—†ìŒ")+'</div><button onclick="location.href=location.href.split(\\'?\\')[0]" style="width:90%;padding:15px;background:#667eea;color:white;border:none;border-radius:10px;font-weight:bold;cursor:pointer;font-size:1.1em">ëŒì•„ê°€ê¸°</button></div>';return}catch(e){console.error('Admin:',e)}}startApp()});` :
'window.addEventListener(\'DOMContentLoaded\',startApp);';

    const timerHTML = config.enableTimer ? '<div id="timer" style="text-align:right;font-weight:bold;color:#e74c3c;margin-bottom:15px;font-size:1.05em">â± <span id="timeText">ì…ë ¥ ê°€ëŠ¥</span></div>' : '';
    
    const timerFunction = config.enableTimer ?
`function startWaitTimer(){if(timerInterval)clearInterval(timerInterval);timeLeft=C.wait*60;const btn=document.getElementById("subBtn");const timeText=document.getElementById("timeText");btn.style.opacity="0.5";btn.innerText="â± ëŒ€ê¸° ì¤‘...";btn.disabled=true;timerInterval=setInterval(()=>{if(timeLeft<=0){clearInterval(timerInterval);timerInterval=null;btn.style.opacity="1";btn.innerText="ğŸ“ ë‹µì•ˆ ì œì¶œí•˜ê¸°";btn.disabled=false;timeText.innerText="ì…ë ¥ ê°€ëŠ¥";return}timeLeft--;const m=Math.floor(timeLeft/60),s=timeLeft%60;timeText.innerText="ë‹¤ìŒ ë„ì „ê¹Œì§€ "+m+"ë¶„ "+(s<10?"0"+s:s)+"ì´ˆ";},1000)}` :
`function startWaitTimer(){setTimeout(()=>{alert("${config.waitMin}ë¶„ í›„ì— ë‹¤ì‹œ ë„ì „í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");document.getElementById("subBtn").disabled=false;document.getElementById("subBtn").innerText="ğŸ“ ë‹µì•ˆ ì œì¶œí•˜ê¸°"},100)}`;

    return `<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>${config.title}</title>
<script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js" crossorigin="anonymous"><\/script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:20px;margin:0;min-height:100vh;color:#2d3436}
.container{max-width:700px;margin:0 auto;background:#fff;padding:40px;border-radius:30px;box-shadow:0 25px 70px rgba(0,0,0,0.15);animation:fadeIn 0.5s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
h1{text-align:center;font-size:2em;font-weight:800;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px}
h2{text-align:center;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:15px;font-size:1.7em;font-weight:800}
.notice-box{background:linear-gradient(135deg,#fff9f0 0%,#ffe4b5 100%);border:2px dashed #ffcc80;border-radius:20px;padding:25px;margin:25px 0;text-align:left;line-height:1.9}
.notice-box h3{color:#e65100;margin-bottom:15px;font-size:1.2em}
.notice-box p{color:#5d4037;font-size:0.95em}
.subject-selector{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px}
.sub-btn{padding:18px;border:3px solid #e9ecef;border-radius:15px;background:#fff;font-weight:700;cursor:pointer;transition:all 0.3s ease;font-size:1.05em}
.sub-btn:hover{border-color:#667eea;transform:translateY(-2px);box-shadow:0 5px 15px rgba(102,126,234,0.2)}
.sub-btn.active{border-color:#667eea;background:linear-gradient(135deg,#f0edff 0%,#e8e4ff 100%);color:#667eea;box-shadow:0 5px 15px rgba(102,126,234,0.3)}
.q-card{border:2px solid #f1f3f5;border-radius:20px;padding:22px;margin-bottom:15px;background:#fff;transition:all 0.3s ease;box-shadow:0 2px 8px rgba(0,0,0,0.04)}
.q-card:hover{border-color:#667eea;box-shadow:0 4px 15px rgba(102,126,234,0.15)}
.q-card b{font-size:1.15em;color:#2d3436}
.ans-row{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-top:15px}
input[type="radio"]{position:absolute;opacity:0}
label{height:52px;display:flex;align-items:center;justify-content:center;border:2px solid #e9ecef;border-radius:12px;cursor:pointer;font-weight:700;background:#fff;transition:all 0.2s ease;font-size:1.05em}
label:hover{border-color:#667eea;transform:translateY(-2px);box-shadow:0 4px 12px rgba(102,126,234,0.2)}
input[type="radio"]:checked+label{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border-color:transparent;box-shadow:0 5px 15px rgba(102,126,234,0.4)}
input[type="radio"]:disabled+label{background:#e9ecef;color:#adb5bd;cursor:not-allowed;border-color:#dee2e6}
input[type="radio"]:disabled+label:hover{transform:none;box-shadow:none}
#overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:999;align-items:center;justify-content:center}
.main-btn{width:100%;padding:20px;border:none;border-radius:16px;font-weight:700;cursor:pointer;font-size:1.15em;transition:all 0.3s ease;margin-top:20px}
.main-btn:hover{transform:translateY(-3px)}
.main-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none}
.btn-submit{background:linear-gradient(135deg,#ff6b6b 0%,#ee5a6f 100%);color:#fff;box-shadow:0 5px 20px rgba(255,107,107,0.4)}
.btn-kakao{background:#FEE500;color:#3c1e1e;box-shadow:0 5px 20px rgba(254,229,0,0.3)}
.input-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:15px}
input,select{padding:14px 16px;border:2px solid #e9ecef;border-radius:12px;width:100%;box-sizing:border-box;outline:none;font-size:0.95em;transition:all 0.2s ease;font-family:inherit}
input:focus,select:focus{border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.1)}
.link-btn{display:flex;align-items:center;justify-content:center;background:#e9ecef;color:#2d3436;text-decoration:none;border-radius:12px;font-weight:700;font-size:0.9em;padding:14px;transition:all 0.2s ease}
.link-btn:hover{background:#dee2e6;transform:translateY(-2px)}
.start-btn{width:100%;padding:22px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;border-radius:20px;font-size:1.3em;font-weight:800;cursor:pointer;box-shadow:0 8px 25px rgba(102,126,234,0.4);transition:all 0.3s ease}
.start-btn:hover{transform:translateY(-3px);box-shadow:0 12px 35px rgba(102,126,234,0.5)}
.overlay-content{background:#fff;padding:35px;border-radius:20px;text-align:center;max-width:90%;width:350px;box-shadow:0 20px 60px rgba(0,0,0,0.3);animation:popIn 0.3s ease}
@keyframes popIn{from{opacity:0;transform:scale(0.9)}to{opacity:1;transform:scale(1)}}
.result-box{padding:30px;background:linear-gradient(135deg,#f0edff 0%,#e8e4ff 100%);border-radius:18px;text-align:center;border:3px solid #667eea;margin-top:20px}
.result-box h3{color:#667eea;margin-bottom:15px;font-size:1.5em}
</style>
<script>${adminViewCode}<\/script>
</head>
<body>
<div id="overlay"></div>
<div class="container">
<div id="introPage" style="text-align:center;padding:20px 0">
<h1>1êµì‹œ ê¹€í˜„ì„ êµ­ì–´</h1>
<div class="notice-box">
<h3>ğŸ“¢ í•„ìˆ˜ ê³µì§€ì‚¬í•­</h3>
<p>${config.notice}</p>
<p style="margin-top:15px">ğŸ“… ì œì¶œ ê¸°í•œ: ${config.startDay} ~ ${config.endDay}<br>ğŸ”„ ìµœëŒ€ ë„ì „: ${config.maxT}íšŒ${config.enableTimer ? '<br>â± ì¬ë„ì „ ëŒ€ê¸°ì‹œê°„: ' + config.waitMin + 'ë¶„' : ''}</p>
</div>
<button onclick="startApp()" class="start-btn">âœ… í™•ì¸í–ˆìŠµë‹ˆë‹¤. ê³¼ì œ ì‹œì‘!</button>
</div>
<div id="examPage" style="display:none">
<h2>${config.title}</h2>
${timerHTML}
<div class="subject-selector">
<button id="btn_A" class="sub-btn active" onclick="setSubject('A')">${config.typeAName}</button>
<button id="btn_B" class="sub-btn" onclick="setSubject('B')">${config.typeBName}</button>
</div>
<div class="input-grid">
<input type="text" id="cN" placeholder="í•™ì›ëª… ì…ë ¥">
<input type="text" id="sN" placeholder="í•™ìƒ ì´ë¦„ ì…ë ¥">
</div>
<div class="input-grid">
<select id="sD"></select>
<a id="paperLink" href="${config.pdf_A}" target="_blank" class="link-btn">ğŸ“„ ë¬¸ì œì§€ ë³´ê¸°</a>
</div>
<div id="qC"></div>
<button id="subBtn" class="main-btn btn-submit" onclick="submit()">ğŸ“ ë‹µì•ˆ ì œì¶œí•˜ê¸°</button>
<button id="kakaoBtn" class="main-btn btn-kakao" onclick="share()" style="display:none">ğŸŸ¡ ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì œì¶œ í™•ì¸</button>
<div id="resArea" style="display:none"></div>
</div>
</div>
<script>
const C={title:"${config.title}",start:"${config.startDay}",end:"${config.endDay}",max:${config.maxT},wait:${config.waitMin},gas:"${config.gasUrl}",ansL:"${config.ansLink}",prefix:"${config.hwId}_"};
const PDFS={A:"${config.pdf_A}",B:"${config.pdf_B}"};
const ANS={A:[0,${config.ans_A.split('').join(',')}],B:[0,${config.ans_B.split('').join(',')}]};
const TOTAL={A:${config.totalQ_A},B:${config.totalQ_B}};
const ACTIVE={A:[${config.activeList_A.join(',')}],B:[${config.activeList_B.join(',')}]};
const NAMES={A:"${config.typeAName}",B:"${config.typeBName}"};
let curSub="A",wCount=0,wrongListStr="",att=0,isPerf=false,resT="",timeLeft=0,timerInterval=null,kakaoInitialized=false;
function initKakao(){if(kakaoInitialized)return;try{if(typeof Kakao!=='undefined'&&!Kakao.isInitialized()){Kakao.init("${config.kakaoKey}");kakaoInitialized=true}}catch(e){console.error('Kakao:',e)}}
setTimeout(initKakao,100);
function startApp(){document.getElementById('introPage').style.display='none';document.getElementById('examPage').style.display='block';window.scrollTo(0,0);init()}
function setSubject(s){if(s==='B'&&ANS.B.length<=1){alert('íƒ€ì… BëŠ” ì œê³µë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');return}curSub=s;document.getElementById("btn_A").className="sub-btn"+(s==='A'?' active':'');document.getElementById("btn_B").className="sub-btn"+(s==='B'?' active':'');document.getElementById("paperLink").href=PDFS[s];renderQ()}
function init(){const sel=document.getElementById("sD");sel.innerHTML='<option value="">ì œì¶œì¼ ì„ íƒ</option>';let loop=new Date(C.start);const end=new Date(C.end);while(loop<=end){let s=loop.toISOString().split('T')[0];let o=document.createElement("option");o.value=s;o.innerText=s;sel.appendChild(o);loop.setDate(loop.getDate()+1)}document.getElementById("paperLink").href=PDFS[curSub];renderQ()}
function renderQ(){let h="";const total=TOTAL[curSub];const active=ACTIVE[curSub];for(let i=1;i<=total;i++){const dis=active.includes(i)?"":"disabled";h+='<div class="q-card"><b>'+i+'ë²ˆ</b><div class="ans-row">';for(let j=1;j<=5;j++){h+='<input type="radio" name="q'+i+'" id="q'+i+'_'+j+'" value="'+j+'" '+dis+'><label for="q'+i+'_'+j+'">'+j+'</label>'}h+='</div></div>'}document.getElementById("qC").innerHTML=h}
function submit(){const cN=document.getElementById("cN").value.trim(),sN=document.getElementById("sN").value.trim().replace(/\\s/g,""),sD=document.getElementById("sD").value;if(!cN||!sN||!sD){alert("í•™ì›ëª…, í•™ìƒ ì´ë¦„, ì œì¶œì¼ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}wCount=0;let wList=[];const total=TOTAL[curSub];const active=ACTIVE[curSub];for(let i=1;i<=total;i++){if(!active.includes(i))continue;let selected=document.querySelector('input[name="q'+i+'"]:checked');let userAns=selected?parseInt(selected.value):0;if(i<ANS[curSub].length&&userAns!==ANS[curSub][i]){wCount++;wList.push(i)}}isPerf=(wCount===0);wrongListStr=wList.join(",");const key="att_"+sN+"_"+C.prefix+curSub;att=parseInt(localStorage.getItem(key)||0)+1;localStorage.setItem(key,att);${config.enablePerfect?'if(isPerf)localStorage.setItem("perf_"+sN+"_"+C.prefix+curSub,"true");':''}resT="["+C.title+"] "+sN+"("+att+"íšŒì°¨)\\n"+NAMES[curSub]+" ì œì¶œ ì™„ë£Œ\\nì˜¤ë‹µ: "+wCount+"ê°œ";document.getElementById("subBtn").style.display="none";document.getElementById("kakaoBtn").style.display="block";fetch(C.gas,{method:"POST",mode:"no-cors",headers:{'Content-Type':'application/json'},body:JSON.stringify({exam:C.title+"_"+curSub,name:sN,class:cN,type:NAMES[curSub],attempt:att,wrongCount:wCount,wrongList:wrongListStr,submitDate:sD})}).catch(err=>console.error('Submit:',err))}
${timerFunction}
function share(){initKakao();if(!kakaoInitialized||typeof Kakao==='undefined'||!Kakao.Share){alert('ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\nì œì¶œì€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');done();return}try{Kakao.Share.sendDefault({objectType:"text",text:resT,link:{mobileWebUrl:window.location.href,webUrl:window.location.href}});setTimeout(()=>{const o=document.getElementById("overlay");o.style.display="flex";o.innerHTML='<div class="overlay-content"><p style="font-size:1.15em;font-weight:600;margin-bottom:20px">ğŸ“± ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì „ì†¡í•˜ì…¨ë‚˜ìš”?</p><button onclick="done()" style="padding:14px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:white;border:none;border-radius:12px;font-weight:700;width:100%;cursor:pointer;font-size:1.05em">ë„¤, ì™„ë£Œí–ˆìŠµë‹ˆë‹¤</button></div>'},1500)}catch(e){console.error('Kakao:',e);alert('ì¹´ì¹´ì˜¤í†¡ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\\nì œì¶œì€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');done()}}
function done(){document.getElementById("overlay").style.display="none";document.getElementById("kakaoBtn").style.display="none";${config.enablePerfect?'if(isPerf){const r=document.getElementById("resArea");r.style.display="block";r.innerHTML=\\'<div class="result-box"><h3>ğŸ‰ ë§Œì  ë‹¬ì„±!</h3><p>ì™„ë²½í•˜ê²Œ í•´ê²°í–ˆìŠµë‹ˆë‹¤!</p><a href="\\'+C.ansL+\\'\" target=\"_blank\" style=\"display:block;padding:16px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;text-decoration:none;border-radius:12px;font-weight:700;margin-top:15px\">ğŸ“˜ í•´ì„¤ì§€ ë³´ê¸°</a></div>\\';return}':''}if(att>=C.max){const r=document.getElementById("resArea");r.style.display="block";r.innerHTML='<div class="result-box"><h3>ğŸ ê¸°íšŒ ì†Œì§„</h3><p>ëª¨ë“  ë„ì „ì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.</p><a href="'+C.ansL+'" target="_blank" style="display:block;padding:16px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;text-decoration:none;border-radius:12px;font-weight:700;margin-top:15px">ğŸ“˜ í•´ì„¤ì§€ ë³´ê¸°</a></div>';return}let feedback="";if(att===1){feedback="ğŸ“Š 1íšŒì°¨ ê²°ê³¼: <b>ì˜¤ë‹µ "+wCount+"ê°œ</b><br><small style='color:#7f8c8d'>ì–´ë–¤ ë¬¸í•­ì´ í‹€ë ¸ëŠ”ì§€ ìŠ¤ìŠ¤ë¡œ ì°¾ì•„ë³´ì„¸ìš”!</small>"}else{feedback="ğŸ“Š "+att+"íšŒì°¨ ê²°ê³¼: <b>ì˜¤ë‹µ "+wCount+"ê°œ</b><br><b style='color:#e74c3c'>í‹€ë¦° ë¬¸í•­: "+wrongListStr+"</b>"}const r=document.getElementById("resArea");r.style.display="block";r.innerHTML='<div class="result-box"><h3>ì±„ì  ì™„ë£Œ</h3><p style="line-height:1.8;font-size:1.05em">'+feedback+'</p><button onclick="location.reload()" style="width:100%;padding:16px;background:#e9ecef;color:#2d3436;border:none;border-radius:12px;margin-top:12px;cursor:pointer;font-weight:700;font-size:1.05em">ğŸ”„ ë‹¤ì‹œ ë„ì „í•˜ê¸° ('+att+'/'+C.max+')</button></div>';startWaitTimer()}
<\/script>
</body>
</html>`;
}
</script>
</body>
</html>