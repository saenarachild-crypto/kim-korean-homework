<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>ì£¼ê°„ê³¼ì œ 1ì›” 3íšŒì°¨ ë¬¸í•™</title>
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        :root { --p: #6c5ce7; --bg: #f8f9fc; --border: #e2e8f0; }
        body { background: var(--bg); font-family: 'Pretendard', sans-serif; margin: 0; padding: 20px; color: #2d3436; }
        .container { max-width: 650px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.03); }
        
        h1 { text-align: center; font-size: 1.8em; margin-bottom: 10px; font-weight: 800; }
        .timer-display { text-align: right; color: #ff7675; font-weight: bold; font-size: 1.1em; margin-bottom: 10px; }
        
        /* ê³µì§€ì‚¬í•­ ë°•ìŠ¤ */
        .notice-box { background: #fff9f0; border-radius: 15px; padding: 20px; margin-bottom: 25px; line-height: 1.7; font-size: 0.95em; border: 1px solid #ffecce; }
        .notice-box b { color: #d35400; }

        /* ì…ë ¥ ì„¹ì…˜ */
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        input, select { width: 100%; padding: 15px; border: 1px solid var(--border); border-radius: 12px; font-size: 1em; box-sizing: border-box; outline: none; transition: 0.2s; }
        input:focus { border-color: var(--p); box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.1); }
        
        .action-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px; }
        .btn-paper { background: #f1f2f6; border: none; border-radius: 12px; padding: 15px; cursor: pointer; text-decoration: none; color: #4b4b4b; text-align: center; font-size: 0.95em; font-weight: bold; }

        /* ë¬¸í•­ ì¹´ë“œ */
        .q-card { border: 1px solid var(--border); border-radius: 15px; padding: 20px; margin-bottom: 20px; }
        .q-num { font-weight: 800; font-size: 1.2em; margin-bottom: 15px; display: block; }
        .ans-row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        
        input[type="radio"] { display: none; }
        label { 
            height: 50px; display: flex; align-items: center; justify-content: center; 
            border: 1px solid var(--border); border-radius: 10px; cursor: pointer; 
            font-weight: 700; font-size: 1.1em; transition: 0.2s; background: #fff;
        }
        input[type="radio"]:checked + label { background: var(--p); color: white; border-color: var(--p); box-shadow: 0 5px 15px rgba(108, 92, 231, 0.3); }

        /* í•˜ë‹¨ ê³ ì • ë²„íŠ¼ area */
        .submit-area { margin-top: 40px; position: sticky; bottom: 20px; }
        .main-btn { width: 100%; padding: 20px; border: none; border-radius: 15px; font-size: 1.2em; font-weight: bold; cursor: pointer; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        #submitBtn { background: var(--p); color: white; }
        #kakaoBtn { background: #fee500; color: #3c1e1e; display: none; }
        #submitBtn:disabled { background: #cbd5e0; cursor: not-allowed; }

        /* ê²°ê³¼ ì°½ */
        .result-card { display: none; margin-top: 25px; padding: 25px; border-radius: 20px; border: 3px solid var(--p); background: #fcfaff; }
    </style>
</head>
<body>

<div class="container">
    <h1>ì£¼ê°„ê³¼ì œ 1ì›” 3íšŒì°¨ ë¬¸í•™</h1>
    <div id="timerDisplay" class="timer-display">â± --ë¶„ --ì´ˆ ë‚¨ìŒ</div>

    <div class="notice-box">
        <b>[ê³µì§€]</b> - ìˆ˜ì • ë‹µì•ˆì´ í•µì‹¬ì…ë‹ˆë‹¤. ìµœëŒ€í•œ ë„ì „ íšŸìˆ˜ë¥¼ ì§€ì¼œì„œ ë°±ì ì— ë„ì „í•˜ì„¸ìš”.<br>
        - ë§ˆê° ê¸°ì¼ì„ ì§€ì¼œì£¼ì‹œê³  ì¹´í†¡ì„ ë°˜ë“œì‹œ ë³´ë‚´ì£¼ì„¸ìš”.<br>
        ğŸ“… ê¸°í•œ: 2026-01-23 ~ 2026-01-26<br>
        ğŸ”„ ì´ 3íšŒ ë„ì „ ê°€ëŠ¥
    </div>

    <div class="input-grid">
        <input type="text" id="academyName" placeholder="í•™ì›ëª…">
        <input type="text" id="stuName" placeholder="í•™ìƒ ì´ë¦„">
    </div>
    
    <div class="action-grid">
        <select id="submitDay">
            <option value="">ì œì¶œì¼ ì„ íƒ</option>
            <option value="1ì›”23ì¼">1ì›” 23ì¼</option>
            <option value="1ì›”24ì¼">1ì›” 24ì¼</option>
            <option value="1ì›”25ì¼">1ì›” 25ì¼</option>
            <option value="1ì›”26ì¼">1ì›” 26ì¼</option>
        </select>
        <a href="https://goe2427-my.sharepoint.com/:b:/g/personal/pure173_jeonghyeonh_goe_go_kr/IQB_NRszigFmTrQISqktkybTAQWFrLd2IPO-oUtUWmZJ6wM?e=rFfzXM" target="_blank" class="btn-paper">ğŸ“„ ë¬¸ì œì§€</a>
    </div>

    <form id="quizForm">
        <div id="questionsContainer"></div>

        <div class="submit-area">
            <button type="button" id="submitBtn" class="main-btn" onclick="submitData()">ì œì¶œí•˜ê¸°</button>
            <button type="button" id="kakaoBtn" class="main-btn" onclick="shareKakao()">ì¹´í†¡ìœ¼ë¡œ ê²°ê³¼ í™•ì¸ ë° ê³µìœ </button>
        </div>
    </form>

    <div id="resultCard" class="result-card">
        <h2 id="resScore" style="margin:0 0 10px 0; color:var(--p)"></h2>
        <p id="resFeedback" style="font-weight:600; font-size:1.1em;"></p>
        <div id="resWrongs" style="margin-top:15px; color:#e74c3c; font-weight:bold; line-height:1.5"></div>
    </div>
</div>

<script>
    const CONFIG = {
        id: "2601_03_LIT",
        ans: "1321525524145132442143332454332",
        gas: "https://script.google.com/macros/s/AKfycbwtzD2n-5ksERWy2iqE1dB4g36RfWfpP0DhvutxJcYTOSZP8u-xvLHUNZcFgMNkjbF1/exec",
        maxTry: 3,
        waitMin: 1
    };

    let tryCount = localStorage.getItem(CONFIG.id + '_tries') || 0;

    // ë¬¸í•­ ìƒì„± (ì´ë¯¸ì§€ UI ë°©ì‹)
    const container = document.getElementById('questionsContainer');
    for(let i=1; i<=CONFIG.ans.length; i++) {
        let html = `<div class="q-card"><span class="q-num">${i}ë²ˆ</span><div class="ans-row">`;
        for(let j=1; j<=5; j++) {
            html += `<input type="radio" name="q${i}" value="${j}" id="q${i}_${j}"><label for="q${i}_${j}">${j}</label>`;
        }
        html += `</div></div>`;
        container.innerHTML += html;
    }

    // ì œì¶œ ë¡œì§
    async function submitData() {
        const academy = document.getElementById('academyName').value;
        const name = document.getElementById('stuName').value;
        const day = document.getElementById('submitDay').value;
        
        if(!academy || !name || !day) return alert("í•™ì›ëª…, ì´ë¦„, ì œì¶œì¼ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.");
        
        const userAns = [];
        for(let i=1; i<=CONFIG.ans.length; i++) {
            const val = document.querySelector(`input[name="q${i}"]:checked`)?.value;
            if(!val) return alert(i + "ë²ˆ ì •ë‹µì„ ì„ íƒí•˜ì„¸ìš”.");
            userAns.push(Number(val));
        }

        tryCount++;
        const master = CONFIG.ans.split("").map(Number);
        let correct = 0, wrongs = [];
        userAns.forEach((v, i) => { v === master[i] ? correct++ : wrongs.push(i+1); });

        const score = Math.round((correct/CONFIG.ans.length)*100);
        window.latestResult = { academy, name, day, score, try: tryCount, wrongCount: wrongs.length, wrongs: wrongs.join(", ") };

        // GAS ì „ì†¡
        fetch(CONFIG.gas, { method: "POST", body: JSON.stringify(window.latestResult) });

        localStorage.setItem(CONFIG.id + '_tries', tryCount);
        localStorage.setItem(CONFIG.id + '_lock', new Date().getTime() + (CONFIG.waitMin * 60000));
        
        document.getElementById('submitBtn').style.display = 'none';
        document.getElementById('kakaoBtn').style.display = 'block';
        alert("ì œì¶œ ì™„ë£Œ! ì¹´í†¡ ê³µìœ  í›„ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.");
        checkTimer();
    }

    function shareKakao() {
        const res = window.latestResult;
        document.getElementById('resultCard').style.display = 'block';
        document.getElementById('resScore').innerText = `ì„±ì : ${res.score}ì `;
        
        let feedback = `í˜„ì¬ ${res.try}íšŒì°¨ ì œì¶œ ì™„ë£Œ. `;
        if(res.try < CONFIG.maxTry - 1) {
            feedback += `ì˜¤ë‹µì€ ì´ ${res.wrongCount}ê°œì…ë‹ˆë‹¤.`;
        } else if(res.try == CONFIG.maxTry - 1) {
            feedback += `[ì§‘ì¤‘] í‹€ë¦° ë²ˆí˜¸: ${res.wrongs}`;
        } else {
            feedback += `ìµœì¢… ì œì¶œ ì™„ë£Œ! ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤.`;
        }
        document.getElementById('resFeedback').innerText = feedback;
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    function checkTimer() {
        const subBtn = document.getElementById('submitBtn');
        const timerDisk = document.getElementById('timerDisplay');
        
        setInterval(() => {
            const lock = localStorage.getItem(CONFIG.id + '_lock');
            const now = new Date().getTime();
            
            if(tryCount >= CONFIG.maxTry) {
                subBtn.disabled = true;
                timerDisk.innerText = "â± ì œì¶œ ê¸°íšŒ ì†Œì§„";
            } else if(lock && now < lock) {
                subBtn.disabled = true;
                const diff = Math.ceil((lock - now) / 1000);
                timerDisk.innerText = `â± ${Math.floor(diff/60)}ë¶„ ${diff%60}ì´ˆ ë‚¨ìŒ`;
            } else {
                subBtn.disabled = false;
                timerDisk.innerText = "â± ì œì¶œ ê°€ëŠ¥";
                if(window.latestResult && subBtn.style.display === 'none') {
                    subBtn.style.display = 'block';
                    document.getElementById('kakaoBtn').style.display = 'none';
                }
            }
        }, 1000);
    }
    checkTimer();
</script>

</body>
</html>