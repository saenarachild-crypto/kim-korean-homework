<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ì£¼ê°„ê³¼ì œ 1ì›” 3íšŒì°¨ ë¬¸í•™</title>
<script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js"></script>
<style>
/* ğŸ›¡ï¸ ì„ ìƒë‹˜ì˜ ê¸°ë³¸ ê³¨ê²© ë””ìì¸ ìœ ì§€ */
:root{--p:#6c5ce7;--bg:#f8f9fc}body{font-family:-apple-system,sans-serif;background:var(--bg);padding:15px;margin:0}.container{max-width:600px;margin:0 auto;background:#fff;padding:25px;border-radius:20px;box-shadow:0 10px 25px rgba(0,0,0,0.1)}.notice-box{background:#fff3e0;padding:15px;border-radius:12px;margin-bottom:20px;font-size:0.9rem;color:#5d4037;line-height:1.6}.q-card{background:#fff;border:1.5px solid #eee;border-radius:15px;padding:20px;margin-bottom:12px}.options{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;position:relative}.opt-input{position:absolute;width:0;height:0;opacity:0;pointer-events:none}.opt-label{height:45px;border:1.5px solid #eee;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:bold;cursor:pointer;transition:0.2s;position:relative;z-index:1}.opt-input:checked+.opt-label{background:var(--p);color:#fff;box-shadow:0 5px 12px rgba(108,92,231,0.3)}.opt-input:disabled+.opt-label{background:#eee;color:#bbb;cursor:not-allowed;border:none}#timer{font-weight:bold;color:#ff6b6b;text-align:right;font-size:1.0rem;margin-bottom:10px}#overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:99;align-items:center;justify-content:center}input,select{padding:12px;border:1px solid #ddd;border-radius:10px;width:100%;box-sizing:border-box;outline:none}
</style>
</head>
<body>
<div id="overlay"></div>
<div class="container">
    <h2 style="text-align:center">ì£¼ê°„ê³¼ì œ 1ì›” 3íšŒì°¨ ë¬¸í•™</h2>
    <div id="timer">â± <span id="timeText">ì…ë ¥ ê°€ëŠ¥</span></div>
    <div class="notice-box"><b>[ê³µì§€]</b> ì‹œí—˜ì§€ë¥¼ ì„ íƒí•˜ê³  ìì •ê¹Œì§€ ì œì¶œí•˜ì„¸ìš”. ë¯¸ì œì¶œ ì‹œ ë¶„ì„ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
    
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px">
        <input type="text" id="cN" placeholder="í•™ì›ëª…"> 
        <input type="text" id="sN" placeholder="í•™ìƒ ì´ë¦„">
    </div>
    
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px">
        <select id="sD"><option value="2026-01-24">2026-01-24</option></select>
        <a href="https://goe2427-my.sharepoint.com/:b:/g/personal/pure173_jeonghyeonh_goe_go_kr/IQB_NRszigFmTrQISqktkybTAQWFrLd2IPO-oUtUWmZJ6wM?e=rFfzXM" target="_blank" style="display:flex;align-items:center;justify-content:center;background:#2d3436;color:white;text-decoration:none;border-radius:10px;font-weight:bold;font-size:0.8rem">ğŸ“„ ë¬¸ì œì§€ ë³´ê¸°</a>
    </div>

    <div id="qC"></div>
    
    <button id="subBtn" onclick="submit()" style="width:100%;padding:20px;background:var(--p);color:white;border:none;border-radius:15px;font-weight:bold;margin-top:20px;cursor:pointer;font-size:1.1rem">ğŸ“ ë‹µì•ˆ ì œì¶œ ë° ì±„ì </button>
    <button id="kakaoBtn" onclick="share()" style="display:none;width:100%;background:#fee500;color:#3c1e1e;border:none;padding:20px;border-radius:15px;font-weight:bold;margin-top:20px;cursor:pointer;font-size:1.1rem">ğŸŸ¡ ì¹´í†¡ ì „ì†¡ í›„ ê²°ê³¼ í™•ì¸</button>
    <div id="resArea" style="display:none;margin-top:20px"></div>
</div>

<script>
let w=0, att=0, isPerfect=false, wrongListStr="", resT="";
const masterAnswers = [0, ..."1321525524145132442143332454332".split("").map(Number)];
const totalQ = 31;
const KAKAO_KEY = "f81d5eae0eaaf6fa2d0bdccbe6916001", 
      GAS_URL = "https://script.google.com/macros/s/AKfycbxtPu2ZsmP7HOt93FGri3W86YV7i0U-71BbAl9cXclpxZJGTXcSE8ejOwuv8RTdE0bP/exec",
      ADMIN_BASE = "https://saenarachild-crypto.github.io/kim-korean-homework/";

try { if(!Kakao.isInitialized()){ Kakao.init(KAKAO_KEY); } } catch(e) {}

// ë¬¸ì œ ìƒì„±
let h=""; for(let n=1; n<=totalQ; n++){
    h+="<div class='q-card'><div style='font-weight:bold;margin-bottom:15px'>"+n+"ë²ˆ</div><div class='options'>";
    for(let j=1;j<=5;j++){ h+="<input type='radio' name='q"+n+"' id='q"+n+"_"+j+"' value='"+j+"' class='opt-input'><label for='q"+n+"_"+j+"' class='opt-label'>"+j+"</label>"; }
    h+="</div></div>";
} document.getElementById("qC").innerHTML=h;

function submit(){
    const cN=document.getElementById("cN").value, sN=document.getElementById("sN").value.trim();
    if(!cN||!sN){alert("í•™ì›ëª…ê³¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!"); return;}
    
    w=0; let d=[]; 
    for(let i=1; i<=totalQ; i++){
        let s=document.querySelector("input[name='q"+i+"']:checked");
        let v=s?parseInt(s.value):0;
        if(v!==masterAnswers[i]){w++; d.push(i);}
    }
    isPerfect=(w===0); wrongListStr=d.join(",");
    const key="att_"+sN+"_HW3"; att=parseInt(localStorage.getItem(key)||0)+1; localStorage.setItem(key,att);

    resT = `[${cN}] ì œì¶œ ì™„ë£Œ\n${sN} í•™ìƒ (${att}íšŒì°¨)`;
    
    document.getElementById("subBtn").style.display="none";
    document.getElementById("kakaoBtn").style.display="block";
    
    fetch(GAS_URL,{method:"POST",mode:"no-cors",body:JSON.stringify({exam:"1ì›” 3íšŒì°¨ ë¬¸í•™",name:sN,class:cN,attempt:att,wrongCount:w,wrongList:wrongListStr})});
}

function share(){
    // ğŸ›¡ï¸ ë³´ë‚´ì£¼ì‹  ì½”ë“œì˜ ì˜ ë˜ëŠ” í˜¸ì¶œ ë°©ì‹(objectType: "text") ì‚¬ìš©
    const shareObj = {
        objectType: "text",
        text: resT,
        link: { mobileWebUrl: ADMIN_BASE, webUrl: ADMIN_BASE }
    };

    // ğŸ›¡ï¸ 3íšŒì°¨ì¼ ë•Œë§Œ ê²°ê³¼ í™•ì¸ ë²„íŠ¼ ì¶”ê°€ (ê·¸ ì™¸ì—” buttons ì—†ìŒ -> ìì„¸íˆ ë³´ê¸° ë´‰ì‡„)
    if(att >= 3) {
        shareObj.buttons = [{
            title: "ê²°ê³¼ í™•ì¸í•˜ê¸°",
            link: { mobileWebUrl: ADMIN_BASE + "?viewResult=true", webUrl: ADMIN_BASE + "?viewResult=true" }
        }];
    }

    Kakao.Share.sendDefault(shareObj);

    setTimeout(()=>{
        const o=document.getElementById("overlay");
        o.style.display="flex";
        o.innerHTML="<div style='background:white;padding:30px;border-radius:20px;text-align:center'><p style='font-weight:bold'>ì„ ìƒë‹˜ê»˜ ì „ì†¡í•˜ì…¨ë‚˜ìš”?</p><button onclick='done()' style='width:100%;padding:12px;background:#fee500;border:none;border-radius:10px;font-weight:bold;cursor:pointer'>ë„¤, ì™„ë£Œí–ˆìŠµë‹ˆë‹¤</button></div>";
    },1500);
}

function done(){
    document.getElementById("overlay").style.display="none";
    document.getElementById("kakaoBtn").style.display="none";
    document.getElementById("resArea").style.display="block";
    
    let resHtml = `<div style='padding:20px;background:#eeebff;border-radius:15px;text-align:center'><h3>ğŸ“Š ${att}íšŒì°¨ ì±„ì  ê²°ê³¼</h3><p>ì˜¤ë‹µ ê°œìˆ˜: <span style='color:red;font-weight:bold'>${w}ê°œ</span></p>`;
    
    if(att === 2) resHtml += `<p style='color:blue;font-size:0.9rem'>í‹€ë¦° ë²ˆí˜¸ íŒíŠ¸: ${wrongListStr}</p>`;
    if(att >= 3 || isPerfect) resHtml += `<a href='https://saenarachild-crypto.github.io/kim-korean-homework/logo.jpeg' target='_blank' style='display:block;margin-top:10px;padding:12px;background:var(--p);color:white;text-decoration:none;border-radius:10px;font-weight:bold'>ğŸ“˜ ìµœì¢… í•´ì„¤ì§€ ë³´ê¸°</a>`;
    
    resHtml += `</div>`;
    document.getElementById("resArea").innerHTML = resHtml;
    
    if(att < 3 && !isPerfect) {
        document.getElementById("subBtn").style.display="block";
        document.getElementById("subBtn").innerText = "ë‹¤ìŒ íšŒì°¨ ì¬ì œì¶œ";
    }
}
</script>
</body>
</html>