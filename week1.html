<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>2024ë…„ 3ì›” ëª¨ì˜ê³ ì‚¬(ì–¸ë§¤)</title>
<style>
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body { font-family: -apple-system, sans-serif; background: #f0f2f5; margin: 0; padding: 15px; color: #333; }
.container { max-width: 700px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
.header-info { background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #e9ecef; }
.input-group { margin-bottom: 10px; }
.input-group label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.9rem; color: #555; }
.input-group input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
.question-item { padding: 15px 0; border-bottom: 1px solid #eee; }
.question-number { font-weight: bold; color: #2196f3; margin-bottom: 10px; display: block; }
.options { display: flex; justify-content: space-between; max-width: 300px; margin: 0 auto; }
.options label { display: flex; justify-content: center; align-items: center; width: 45px; height: 45px; border: 2px solid #e0e0e0; border-radius: 50%; font-weight: bold; color: #777; cursor: pointer; }
.options input { display: none; }
.options input:checked + label { background: #2196f3; color: white; border-color: #2196f3; }
.btn-submit { display: block; width: 100%; padding: 15px; background: #2c3e50; color: white; border: none; border-radius: 10px; font-weight: bold; font-size: 1.1rem; margin-top: 20px; cursor: pointer; }
.btn-submit:disabled { background: #bdc3c7; }
/* ê²°ê³¼ ì˜ì—­: ì²˜ìŒì—” ìˆ¨ê¹€ */
.result-section { display: none; margin-top: 20px; }
.report-gate { background: #fff3e0; padding: 20px; border-radius: 10px; border: 2px solid #ffb74d; text-align: center; margin-top: 20px; display: none; }
.report-gate h3 { color: #e65100; margin-top: 0; }
.btn-report { background: #ff9800; color: white; width: 100%; padding: 15px; border: none; border-radius: 10px; font-weight: bold; font-size: 1.1rem; cursor: pointer; animation: pulse 2s infinite; }
@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
.result-box { padding: 20px; background: #e3f2fd; border-radius: 10px; text-align: center; margin-top: 20px; }
.wrong-answer { background: #ffebee; border-radius: 5px; } 
.wrong-answer .question-number { color: #d32f2f; }
</style>
</head>
<body>
<div class="container">
<h2 style="text-align:center;">2024ë…„ 3ì›” ëª¨ì˜ê³ ì‚¬(ì–¸ë§¤)</h2>
<div class="header-info">
<div class="input-group"><label>í•™ìƒ ì´ë¦„</label><input type="text" id="studentName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"></div>
<div class="input-group"><label>ê³¼ì œëª…</label><input type="text" value="2024ë…„ 3ì›” ëª¨ì˜ê³ ì‚¬(ì–¸ë§¤)" readonly></div>
</div>
<div id="qList"></div>

<button class="btn-submit" id="submitBtn" onclick="submitAnswers()">ë‹µì•ˆ ì œì¶œí•˜ê¸°</button>

<div id="gatePanel" class="report-gate">
    <h3>ğŸ”’ ê²°ê³¼ê°€ ì ê²¨ìˆìŠµë‹ˆë‹¤</h3>
    <p>ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.<br>ì„ ìƒë‹˜ê»˜ ê²°ê³¼ë¥¼ ì „ì†¡í•´ì•¼ë§Œ<br>ì ìˆ˜ì™€ í‹€ë¦° ë¬¸ì œë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    <button class="btn-report" onclick="reportAndUnlock()">ğŸ“¤ ê²°ê³¼ ì „ì†¡í•˜ê³  ì ìˆ˜ í™•ì¸í•˜ê¸°</button>
</div>

<div id="resultSection" class="result-section">
    <div class="result-box">
        <div id="resultText"></div>
    </div>
</div>

</div>
<script>
const answers = [1,2,2,3,3,1,2,2,1,1,3,3,3,3,2,5,4,2,3,4,1,4,2,4,5,1,3,1,5,5,4,5,5,5,1,4,4,2,3,5,4,4,1,5,2];
const LOCK_KEY = 'time_1767768539248';
const ATTEMPT_KEY = 'try_1767768539248';
let attempt = 0;
let myScoreMsg = ""; // ì „ì†¡í•  ë©”ì‹œì§€ ì €ì¥ìš©

window.onload = function(){
    const c = document.getElementById('qList');
    for(let i=1; i<=45; i++){
        let h = '<div class="question-item" id="qBox'+i+'"><span class="question-number">'+i+'ë²ˆ</span><div class="options">';
        for(let j=1; j<=5; j++) h += '<input type="radio" name="q'+i+'" id="q'+i+'_'+j+'" value="'+j+'"><label for="q'+i+'_'+j+'">'+j+'</label>';
        h += '</div></div>';
        c.innerHTML += h;
    }
    checkTimer(); setInterval(checkTimer, 1000);
    if(localStorage.getItem(ATTEMPT_KEY)) attempt = parseInt(localStorage.getItem(ATTEMPT_KEY));
};

function submitAnswers(){
    const name = document.getElementById('studentName').value;
    if(!name) return alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
    
    // ì±„ì  ë¡œì§ (ë‚´ë¶€ì ìœ¼ë¡œë§Œ ê³„ì‚°)
    attempt++;
    localStorage.setItem(ATTEMPT_KEY, attempt);
    let wrong = 0;
    for(let i=1; i<=45; i++){
        const r = document.querySelector('input[name="q'+i+'"]:checked');
        if(!r || r.value != answers[i-1]) wrong++;
    }
    if(wrong > 0){ localStorage.setItem(LOCK_KEY, Date.now()); }

    // ë©”ì‹œì§€ ë¯¸ë¦¬ ìƒì„±
    myScoreMsg = '['+name+'] 2024ë…„ 3ì›” ëª¨ì˜ê³ ì‚¬(ì–¸ë§¤)\n'+attempt+'íšŒì°¨ ê²°ê³¼: '+wrong+'ê°œ í‹€ë¦¼';
    if(wrong===0) myScoreMsg += ' (ë§Œì )';

    // í™”ë©´ ì „í™˜: ë¬¸ì œ ìˆ¨ê¸°ê³  -> ë³´ê³  ê´€ë¬¸ í‘œì‹œ
    document.getElementById('submitBtn').style.display = 'none';
    document.getElementById('gatePanel').style.display = 'block';
    document.getElementById('gatePanel').scrollIntoView({behavior:'smooth'});
    
    // ì‹¤ì œ ê²°ê³¼ í‘œì‹œëŠ” ë‚˜ì¤‘ì—
    updateResultUI(wrong, name);
}

function updateResultUI(wrong, name){
    const txt = document.getElementById('resultText');
    let msg = '<h3>'+name+' í•™ìƒ: '+wrong+'ê°œ í‹€ë ¸ìŠµë‹ˆë‹¤.</h3>';
    if(wrong===0) msg = '<h3 style="color:green">ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ë§Œì ì…ë‹ˆë‹¤!</h3>';
    else if(attempt < 4) msg += 'í‹€ë¦° ë¬¸ì œ ë²ˆí˜¸ëŠ” 4ë²ˆì§¸ ì‹œë„ì— ê³µê°œë©ë‹ˆë‹¤.<br>30ë¶„ ë’¤ì— ë‹¤ì‹œ ë„ì „í•˜ì„¸ìš”.';
    else msg += '4ë²ˆì§¸ ì‹œë„ì…ë‹ˆë‹¤. í‹€ë¦° ë¬¸í•­ì„ ë¶‰ì€ìƒ‰ìœ¼ë¡œ í‘œì‹œí–ˆìŠµë‹ˆë‹¤.';
    txt.innerHTML = msg;
    
    // í‹€ë¦° ë¬¸ì œ í‘œì‹œ (í™”ë©´ì—” ì•ˆë³´ì´ì§€ë§Œ ë¯¸ë¦¬ í´ë˜ìŠ¤ ì¶”ê°€)
    for(let i=1; i<=45; i++){
        const r = document.querySelector('input[name="q'+i+'"]:checked');
        const box = document.getElementById('qBox'+i);
        box.classList.remove('wrong-answer');
        if(!r || r.value != answers[i-1]){
            if(attempt >= 4) box.classList.add('wrong-answer');
        }
    }
}

function reportAndUnlock(){
    const formUrl = "";
    
    // 1. ì „ì†¡ ë™ì‘ (êµ¬ê¸€í¼ or ì¹´í†¡ê³µìœ )
    if(formUrl){
        // êµ¬ê¸€í¼ì´ ìˆìœ¼ë©´ ìƒˆì°½ ì—´ê¸°
        window.open(formUrl, '_blank');
        alert("êµ¬ê¸€ ì„¤ë¬¸ì§€ê°€ ì—´ë ¸ìŠµë‹ˆë‹¤.\nì ìˆ˜ë¥¼ ì…ë ¥í•˜ê³  ì œì¶œí•˜ì„¸ìš”!\n(í™•ì¸ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì ìˆ˜ê°€ ê³µê°œë©ë‹ˆë‹¤)");
    } else {
        // êµ¬ê¸€í¼ ì—†ìœ¼ë©´ ê³µìœ  ê¸°ëŠ¥ ì‚¬ìš©
        if(navigator.share){
            navigator.share({ title: 'ê³¼ì œ ì œì¶œ', text: myScoreMsg }).catch(console.error);
        } else {
            const t = document.createElement("textarea"); t.value = myScoreMsg; document.body.appendChild(t); t.select(); document.execCommand("copy"); document.body.removeChild(t);
            alert("ê²°ê³¼ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì¹´í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.");
        }
    }

    // 2. ì ê¸ˆ í•´ì œ (ê²°ê³¼ ê³µê°œ)
    document.getElementById('gatePanel').style.display = 'none';
    document.getElementById('resultSection').style.display = 'block';
    document.getElementById('submitBtn').style.display = 'none'; // ì œì¶œ ë²„íŠ¼ ì˜êµ¬ ìˆ¨ê¹€
    checkTimer(); // íƒ€ì´ë¨¸ ì ìš©
}

function checkTimer(){
    const last = localStorage.getItem(LOCK_KEY);
    const msg = document.getElementById('resultText'); 
    if(!last) return;
    
    const diff = Date.now() - parseInt(last);
    const wait = 30 * 60 * 1000;
    
    if(diff < wait){
        const m = Math.floor((wait-diff)/60000);
        const s = Math.floor(((wait-diff)%60000)/1000);
        // íƒ€ì´ë¨¸ ë©”ì‹œì§€ ì¶”ê°€
        if(document.getElementById('resultSection').style.display === 'block'){
             // ê²°ê³¼ì°½ì— íƒ€ì´ë¨¸ í‘œì‹œ
        }
    }
}
</script>
</body>
</html>