<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì£¼ê°„ ê³¼ì œ í†µí•© ì½”ë“œ ìƒì„±ê¸° (ë…ì„œ+ë¬¸í•™)</title>
    <style>
        :root { --p: #6c5ce7; }
        body { font-family: sans-serif; background: #f0f2f5; padding: 20px; line-height: 1.6; }
        .gen-container { max-width: 900px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h1 { color: var(--p); border-bottom: 2px solid var(--p); padding-bottom: 10px; }
        .input-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; color: #333; }
        input, textarea, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 14px; }
        textarea { height: 80px; resize: vertical; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        button { width: 100%; padding: 20px; background: var(--p); color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 20px; }
        #codeOutput { width: 100%; height: 300px; margin-top: 20px; display: none; font-family: monospace; background: #2d3436; color: #dfe6e9; padding: 15px; }
        .help { font-size: 0.85rem; color: #666; margin-top: 4px; }
    </style>
</head>
<body>

<div class="gen-container">
    <h1>ğŸ“˜ ì£¼ê°„ ê³¼ì œ í†µí•© ìƒì„±ê¸° (V11.1)</h1>
    <p>ë…ì„œì™€ ë¬¸í•™ ì •ë‹µì„ ì…ë ¥í•˜ë©´ <b>íƒ­ìœ¼ë¡œ ì„ íƒ ê°€ëŠ¥í•œ í†µí•© ê³¼ì œ ì½”ë“œ</b>ê°€ ìƒì„±ë©ë‹ˆë‹¤.</p>

    <div class="grid">
        <div class="input-group">
            <label>ê³¼ì œ ì œëª©</label>
            <input type="text" id="title" placeholder="ì˜ˆ: 2ì›” 2íšŒì°¨ ì£¼ê°„ ê³¼ì œ">
        </div>
        <div class="input-group">
            <label>ê³¼ì œ ê³ ìœ  ID</label>
            <input type="text" id="hwPrefix" placeholder="ì˜ˆ: HW_FEB_WEEK2_">
        </div>
    </div>

    <div class="grid">
        <div class="input-group">
            <label>ì‹œì‘ì¼</label>
            <input type="date" id="startDay">
        </div>
        <div class="input-group">
            <label>ë§ˆê°ì¼</label>
            <input type="date" id="endDay">
        </div>
    </div>

    <div class="grid">
        <div class="input-group">
            <label>ğŸ“˜ ë…ì„œ ì •ë‹µ (ìˆ«ìë§Œ ë‚˜ì—´)</label>
            <textarea id="ans_reading" placeholder="ì˜ˆ: 25535..."></textarea>
        </div>
        <div class="input-group">
            <label>ğŸ“• ë¬¸í•™ ì •ë‹µ (ìˆ«ìë§Œ ë‚˜ì—´)</label>
            <textarea id="ans_literature" placeholder="ì˜ˆ: 12545..."></textarea>
        </div>
    </div>

    <div class="input-group">
        <label>ë…ì„œ í™œì„±í™” ë¬¸í•­ ë²ˆí˜¸</label>
        <input type="text" id="readingActive" placeholder="ì˜ˆ: 5,6,7,8,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30">
        <div class="help">ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•˜ì„¸ìš”. ë¹„ì›Œë‘ë©´ ë…ì„œ ì „ ë¬¸í•­ì´ í™œì„±í™”ë©ë‹ˆë‹¤.</div>
    </div>

    <div class="grid">
        <div class="input-group">
            <label>ë…ì„œ ë¬¸ì œì§€ ë§í¬</label>
            <input type="text" id="readingPaper" placeholder="http://...">
        </div>
        <div class="input-group">
            <label>ë¬¸í•™ ë¬¸ì œì§€ ë§í¬</label>
            <input type="text" id="literaturePaper" placeholder="http://...">
        </div>
    </div>

    <div class="grid">
        <div class="input-group">
            <label>í†µí•© í•´ì„¤ì§€ ë§í¬</label>
            <input type="text" id="ansLink" placeholder="http://...">
        </div>
        <div class="input-group">
            <label>êµ¬ê¸€ ì•±ìŠ¤í¬ë¦½íŠ¸ ì£¼ì†Œ (ë³€ê²½ ê¸ˆì§€)</label>
            <input type="text" id="gasUrl" value="https://script.google.com/macros/s/AKfycbzkA0CC8GAhcdAP16fzq32ufyTIYolZ8TyeuSjW5FAsG0M3vPcYQOIaSKIOOYKYgtDc/exec">
        </div>
    </div>

    <button onclick="generateCode()">ğŸš€ í†µí•© ê³¼ì œ ì½”ë“œ ìƒì„± ë° ë³µì‚¬</button>

    <textarea id="codeOutput" readonly></textarea>
    <p id="copyMsg" style="text-align:center; color: var(--p); font-weight:bold; display:none;">ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! .html íŒŒì¼ë¡œ ì €ì¥í•˜ì„¸ìš”.</p>
</div>

<script>
    function generateCode() {
        const title = document.getElementById('title').value;
        const hwPrefix = document.getElementById('hwPrefix').value;
        const startDay = document.getElementById('startDay').value;
        const endDay = document.getElementById('endDay').value;
        const ansR = document.getElementById('ans_reading').value.trim();
        const ansL = document.getElementById('ans_literature').value.trim();
        const rPaper = document.getElementById('readingPaper').value;
        const lPaper = document.getElementById('literaturePaper').value;
        const ansLink = document.getElementById('ansLink').value;
        const gasUrl = document.getElementById('gasUrl').value;
        const rActive = document.getElementById('readingActive').value.trim();

        // ë…ì„œ í™œì„±í™” ë¦¬ìŠ¤íŠ¸ ì²˜ë¦¬
        const rActiveArray = rActive ? "[" + rActive + "]" : "Array.from({length:" + ansR.length + "},(_,i)=>i+1)";

        const template = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
    <title>${title} | ê¹€í˜„ì„ êµ­ì–´</title>
    <meta property="og:title" content="ê¹€í˜„ì„ êµ­ì–´ - ${title}">
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        :root { --p: #6c5ce7; --bg: #f8f9fc; --border: #e2e8f0; }
        body { background: var(--bg); font-family: 'Pretendard', sans-serif; margin: 0; padding: 20px; color: #2d3436; -webkit-tap-highlight-color: transparent; }
        .container { max-width: 650px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.03); }
        #introPage { text-align: center; padding: 20px 0; }
        .intro-notice { background: #fff9f0; border: 2px dashed #ffcc80; border-radius: 20px; padding: 25px; margin: 25px 0; text-align: left; }
        .start-btn { width: 100%; padding: 22px; background: var(--p); color: white; border: none; border-radius: 20px; font-size: 1.25em; font-weight: 800; cursor: pointer; transition: 0.3s; }
        #examPage { display: none; } 
        .notice-box { background: #fff3e0; padding: 15px; border-radius: 12px; margin-bottom: 20px; font-size: 0.9rem; color: #5d4037; line-height: 1.6; border: 1px solid #ffcc80; }
        .subject-selector { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .sub-btn { padding: 15px; border: 2px solid #eee; border-radius: 12px; background: #fff; font-weight: bold; cursor: pointer; }
        .sub-btn.active { border-color: var(--p); background: #f0edff; color: var(--p); }
        .q-card { border: 1px solid var(--border); border-radius: 20px; padding: 20px; margin-bottom: 15px; background: #fff; }
        .q-card.disabled { background: #f5f5f5; opacity: 0.6; }
        .options { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        .opt-input { position: absolute; opacity: 0; }
        .opt-label { height: 50px; display: flex; align-items: center; justify-content: center; border: 1px solid var(--border); border-radius: 12px; cursor: pointer; font-weight: 700; }
        .opt-input:checked + .opt-label { background: var(--p); color: white; border-color: var(--p); }
        .opt-input:disabled + .opt-label { cursor: not-allowed; background: #eee; }
        #timer { font-weight: bold; color: #ff6b6b; text-align: right; margin-bottom: 10px; }
        #overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 99; align-items: center; justify-content: center; }
        input, select { padding: 12px; border: 1px solid #ddd; border-radius: 10px; width: 100%; box-sizing: border-box; }
    </style>
</head>
<body>
<div id="overlay"></div>
<div class="container">
    <div id="introPage">
        <img src="https://saenarachild-crypto.github.io/kim-korean-homework/logo.jpg" style="width:140px; border-radius:25px;">
        <h1 style="margin-top:20px;">ê¹€í˜„ì„ êµ­ì–´</h1>
        <div class="intro-notice">
            <h3 style="margin-top:0;">ğŸ“¢ ì£¼ê°„ ê³¼ì œ ì•ˆë‚´</h3>
            <p>ì˜¤ëŠ˜ì˜ ì§€ë¬¸ì„ í™•ì¸í•˜ê³  ì •ë‹µì„ ì œì¶œí•˜ì„¸ìš”.<br>ë…ì„œì™€ ë¬¸í•™ì„ íƒ­ì—ì„œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
        <button class="start-btn" onclick="startApp()">ê³¼ì œ ì‹œì‘í•˜ê¸°</button>
    </div>
    <div id="examPage">
        <h2 style="text-align:center">${title}</h2>
        <div id="timer">â± <span id="timeText">ì…ë ¥ ê°€ëŠ¥</span></div>
        <div class="subject-selector">
            <button id="btn_reading" class="sub-btn active" onclick="setSubject('reading')">ğŸ“˜ ë…ì„œ</button>
            <button id="btn_literature" class="sub-btn" onclick="setSubject('literature')">ğŸ“• ë¬¸í•™</button>
        </div>
        <div id="noticeArea" class="notice-box"><b>[ê³µì§€]</b> ê¸°í•œ: ${startDay} ~ ${endDay}</div>
        <div id="limitMsg" style="display:none;color:#d63031;font-weight:bold;text-align:center;margin-bottom:20px;padding:15px;background:#fab1a0;border-radius:12px"></div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px">
            <input type="text" id="cN" placeholder="í•™ì›ëª…">
            <input type="text" id="sN" placeholder="í•™ìƒ ì´ë¦„" oninput="checkLimit()">
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px">
            <select id="sD" onchange="checkLimit()"><option value="">ì œì¶œì¼ ì„ íƒ</option></select>
            <a id="paperLink" href="${rPaper}" target="_blank" style="display:flex;align-items:center;justify-content:center;background:#eee;color:#333;text-decoration:none;border-radius:10px;font-weight:bold;font-size:0.8rem">ğŸ“„ ë¬¸ì œì§€ ë³´ê¸°</a>
        </div>
        <div id="qC"></div>
        <button id="subBtn" onclick="submit()" style="width:100%;padding:20px;background:#ff6b6b;color:white;border:none;border-radius:15px;font-weight:bold;margin-top:20px;cursor:pointer;font-size:1.1rem">ğŸ“ ë‹µì•ˆ ì œì¶œí•˜ê¸°</button>
        <button id="kakaoBtn" onclick="share()" style="display:none;width:100%;background:#fee500;color:#3c1e1e;border:none;padding:20px;border-radius:15px;font-weight:bold;margin-top:20px;cursor:pointer;font-size:1.1rem">ğŸŸ¡ ì¹´í†¡ìœ¼ë¡œ ì œì¶œ í™•ì¸</button>
        <div id="resArea" style="display:none;margin-top:20px"></div>
    </div>
</div>
<script>
let timeLeft, timerInterval = null, w=0, att=0, isBlocked=false, resT="", isPerfect=false, currentSubject="reading";
const config = { title: "${title}", startDay: "${startDay}", endDay: "${endDay}", maxT: 3, waitMin: 3, ansLink: "${ansLink}", hwPrefix: "${hwPrefix}", gasUrl: "${gasUrl}" };
const data = {
    reading: { ans: [0, ..."${ansR}".split("").map(Number)], active: ${rActiveArray}, paper: "${rPaper}", total: ${ansR.length} },
    literature: { ans: [0, ..."${ansL}".split("").map(Number)], active: Array.from({length:${ansL.length}},(_,i)=>i+1), paper: "${lPaper}", total: ${ansL.length} }
};
let masterAnswers = data.reading.ans;
try{if(!Kakao.isInitialized()){Kakao.init("f81d5eae0eaaf6fa2d0bdccbe6916001");}}catch(e){}
function startApp(){ document.getElementById('introPage').style.display='none'; document.getElementById('examPage').style.display='block'; window.scrollTo(0,0); }
function setSubject(sub){ 
    currentSubject=sub; 
    masterAnswers=data[sub].ans; 
    document.getElementById("btn_reading").className="sub-btn"+(sub==='reading'?' active':''); 
    document.getElementById("btn_literature").className="sub-btn"+(sub==='literature'?' active':'');
    document.getElementById("paperLink").href=data[sub].paper;
    initPage();
}
function initPage(){
    const sel=document.getElementById("sD"); sel.innerHTML='<option value="">ì œì¶œì¼ ì„ íƒ</option>';
    let loopDate=new Date(config.startDay); const end=new Date(config.endDay);
    while(loopDate <= end){ let s=loopDate.toISOString().split('T')[0]; let opt=document.createElement("option"); opt.value=s; opt.innerText=s; sel.appendChild(opt); loopDate.setDate(loopDate.getDate()+1); }
    let h=""; for(let n=1; n<=data[currentSubject].total; n++){
        const isAct = data[currentSubject].active.includes(n);
        h+="<div class='q-card "+(isAct?"":"disabled")+"'><b>"+n+"ë²ˆ</b><div class='options'>";
        for(let j=1;j<=5;j++){ h+="<input type='radio' name='q"+n+"' id='q"+n+"_"+j+"' value='"+j+"' class='opt-input' "+(isAct?"":"disabled")+"><label for='q"+n+"_"+j+"' class='opt-label'>"+j+"</label>"; }
        h+="</div></div>";
    }
    document.getElementById("qC").innerHTML=h; checkDateLimit(); checkLimit();
}
function submit(){
    const cN=document.getElementById("cN").value, sN=document.getElementById("sN").value.trim().replace(/\\s/g,""), sD=document.getElementById("sD").value;
    if(!cN||!sN||!sD){alert("ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”!"); return;}
    w=0; let d=[]; data[currentSubject].active.forEach(n=>{ let s=document.querySelector("input[name='q"+n+"']:checked"); if((s?parseInt(s.value):0)!==masterAnswers[n]){w++; d.push(n);} });
    isPerfect=(w===0); const hwId=config.hwPrefix+currentSubject; const key="att_"+sN+"_"+hwId; att=parseInt(localStorage.getItem(key)||0)+1; localStorage.setItem(key,att); if(isPerfect) localStorage.setItem("perf_"+sN+"_"+hwId,"true");
    resT="["+config.title+" "+(currentSubject==='reading'?'ë…ì„œ':'ë¬¸í•™')+"]\\n"+sN+"("+att+"íšŒì°¨) ì œì¶œ ì™„ë£Œ"; document.getElementById("subBtn").style.display="none"; document.getElementById("kakaoBtn").style.display="block";
    fetch(config.gasUrl,{method:"POST",mode:"no-cors",body:JSON.stringify({exam:config.title+" "+(currentSubject==='reading'?'ë…ì„œ':'ë¬¸í•™'),name:sN,class:cN,attempt:att,wrongCount:w,wrongList:d.join(",")})});
}
function checkDateLimit(){ if(new Date() > new Date(config.endDay).setHours(23,59,59,999)){ isBlocked=true; document.getElementById("subBtn").style.display="none"; document.getElementById("limitMsg").style.display="block"; document.getElementById("limitMsg").innerText="ğŸš« ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤."; } }
function checkLimit(){ const sN=document.getElementById("sN").value.trim(); if(sN.length<2)return; const hwId=config.hwPrefix+currentSubject; if(localStorage.getItem("perf_"+sN+"_"+hwId)=="true"){ showFinalResult("ë°±ì  ë‹¬ì„±!"); return; } if(parseInt(localStorage.getItem("att_"+sN+"_"+hwId)||0)>=config.maxT){ showFinalResult("ê¸°íšŒ ì†Œì§„"); } else { document.getElementById("subBtn").style.display="block"; document.getElementById("limitMsg").style.display="none"; document.getElementById("resArea").style.display="none"; } }
function startWaitTimer(){ timeLeft=config.waitMin*60; const btn=document.getElementById("subBtn"); btn.disabled=true; btn.style.opacity="0.5"; timerInterval=setInterval(()=>{ if(timeLeft<=0){clearInterval(timerInterval); btn.disabled=false; btn.style.opacity="1"; document.getElementById("timeText").innerText="ì…ë ¥ ê°€ëŠ¥"; return;} timeLeft--; const m=Math.floor(timeLeft/60), s=timeLeft%60; document.getElementById("timeText").innerText="ì¬ë„ì „ ëŒ€ê¸°: "+m+"ë¶„ "+(s<10?"0"+s:s)+"ì´ˆ"; },1000); }
function done(){ document.getElementById("overlay").style.display="none"; document.getElementById("kakaoBtn").style.display="none"; if(isPerfect){showFinalResult("ë°±ì  ë‹¬ì„±!"); return;} if(att>=config.maxT){showFinalResult("ê¸°íšŒ ì†Œì§„"); return;} alert(att+"íšŒì°¨ ê²°ê³¼: ì˜¤ë‹µ "+w+"ê°œ"); document.querySelectorAll(".opt-input").forEach(rb=>rb.checked=false); document.getElementById("subBtn").style.display="block"; startWaitTimer(); }
function showFinalResult(msg){ const r=document.getElementById("resArea"); r.style.display="block"; r.innerHTML="<div style='padding:25px;background:#eeebff;border-radius:15px;text-align:center'><h3>ğŸ "+msg+"</h3><a href='"+config.ansLink+"' target='_blank' style='display:block;padding:15px;background:var(--p);color:white;text-decoration:none;border-radius:10px;font-weight:bold'>ğŸ“˜ í•´ì„¤ì§€ ë³´ê¸°</a></div>"; document.getElementById("subBtn").style.display="none"; }
function share(){ Kakao.Share.sendDefault({ objectType:"text", text:resT, link:{ mobileWebUrl:window.location.href, webUrl:window.location.href } }); setTimeout(()=>{document.getElementById("overlay").style.display="flex"; document.getElementById("overlay").innerHTML="<div style='background:white;padding:30px;border-radius:20px;text-align:center'><p>ì¹´í†¡ ì „ì†¡ ì™„ë£Œ?</p><button onclick='done()' style='padding:12px;background:#fee500;border:none;border-radius:10px;font-weight:bold;'>í™•ì¸</button></div>";},1500); }
initPage();
<\/script>
</body>
</html>`;

        const output = document.getElementById('codeOutput');
        output.value = template;
        output.style.display = 'block';
        output.select();
        document.execCommand('copy');
        document.getElementById('copyMsg').style.display = 'block';
    }
</script>
</body>
</html>