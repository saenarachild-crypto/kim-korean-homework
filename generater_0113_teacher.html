<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê³¼ì œ í˜ì´ì§€ ìƒì„±ê¸° v2.0 (ì„ ìƒë‹˜ ì „ìš©)</title>
    <style>
        body { font-family: 'Apple SD Gothic Neo', sans-serif; padding: 20px; background: #f0f2f5; line-height: 1.6; }
        .box { max-width: 800px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h2 { border-left: 5px solid #2196f3; padding-left: 15px; color: #333; margin-bottom: 25px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        label { display: block; margin-top: 15px; font-weight: bold; color: #444; }
        input, textarea, select { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 14px; }
        textarea { height: 80px; resize: none; }
        .btn-group { margin-top: 25px; }
        button { width: 100%; padding: 15px; background: #2196f3; color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background: #1976d2; }
        #output { width: 100%; height: 350px; margin-top: 20px; font-family: 'Consolas', monospace; background: #2d3436; color: #dfe6e9; padding: 15px; border-radius: 8px; font-size: 13px; }
        .section-title { background: #e3f2fd; padding: 10px; border-radius: 5px; margin-top: 20px; font-weight: bold; color: #1976d2; }
    </style>
</head>
<body>
<div class="box">
    <h2>ğŸš€ ê³¼ì œ í˜ì´ì§€ ìƒì„±ê¸° v2.0</h2>
    
    <div class="section-title">ğŸ“… ê¸°ë³¸ ì •ë³´ ì„¤ì •</div>
    <label>ê³¼ì œ ì œëª©</label>
    <input type="text" id="title" placeholder="ì˜ˆ: 1ì›” 3ì£¼ì°¨ ë…ì„œ ìˆ˜ì—… êµì¬">
    
    <label>ì •ë‹µ ë²ˆí˜¸ (ê³µë°±/ê¸°í˜¸ ì—†ì´ ìˆ«ìë§Œ ë‚˜ì—´)</label>
    <textarea id="answers" placeholder="ì˜ˆ: 3114541454..."></textarea>
    
    <div class="grid">
        <div>
            <label>ì‹œí—˜ì§€ PDF ë§í¬</label>
            <input type="text" id="testLink" placeholder="SharePoint ë§í¬">
        </div>
        <div>
            <label>í•´ì„¤ì§€ PDF ë§í¬</label>
            <input type="text" id="ansLink" placeholder="SharePoint ë§í¬">
        </div>
    </div>

    <div class="section-title">âš™ï¸ ì‹œí—˜ ê·œì¹™ ì„¤ì • (ì„ ìƒë‹˜ ì œì–´)</div>
    <div class="grid">
        <div>
            <label>ìµœëŒ€ ë„ì „ íšŸìˆ˜ (íšŒ)</label>
            <input type="number" id="maxAttempts" value="3" min="1">
        </div>
        <div>
            <label>ì¬ì œì¶œ ëŒ€ê¸° ì‹œê°„ (ë¶„)</label>
            <input type="number" id="cooldown" value="3" min="0">
        </div>
    </div>

    <div class="btn-group">
        <button onclick="generateCode()">âœ¨ ë§ì¶¤í˜• HTML ì½”ë“œ ìƒì„±</button>
    </div>

    <label>ğŸ“‹ ê²°ê³¼ ì½”ë“œ ë³µì‚¬</label>
    <textarea id="output" readonly onclick="this.select()" placeholder="ì—¬ê¸°ì— ìƒì„±ëœ ì½”ë“œê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤."></textarea>
    <p style="font-size: 12px; color: #666; text-align: center;">ìœ„ ìƒìë¥¼ í´ë¦­í•˜ë©´ ì „ì²´ ì„ íƒë©ë‹ˆë‹¤. ë³µì‚¬í•´ì„œ HTML íŒŒì¼ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.</p>
</div>

<script>
function generateCode() {
    const title = document.getElementById('title').value || "ì£¼ì°¨ë³„ ê³¼ì œ";
    const rawAns = document.getElementById('answers').value.replace(/[^1-5]/g, '');
    const ansArray = rawAns.split('').map(Number);
    const testLink = document.getElementById('testLink').value || "#";
    const ansLink = document.getElementById('ansLink').value || "#";
    const maxAttempts = document.getElementById('maxAttempts').value || 3;
    const cooldown = document.getElementById('cooldown').value || 3;
    const qCount = ansArray.length;

    if(qCount === 0) return alert("ì •ë‹µì„ ìˆ«ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”!");

    // ì„ ìƒë‹˜ ì „ìš© ê³ ì • SCRIPT_URL
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyE8PE7KjrTiBVljInx24PqPBoFbQ5ga4oWqhMg90UFXjFvrmB0YWhNVreRCWYyeq8/exec";

    const template = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>${title}</title>
    <style>
        body{font-family:-apple-system,sans-serif;background:#f0f2f5;padding:15px;margin:0}
        .container{max-width:600px;margin:0 auto;background:#fff;padding:25px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.1)}
        .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #f0f0f0; padding-bottom: 15px; }
        .title { margin: 5px 0; color: #333; }
        .notice-box { background: #fff3e0; border: 1px solid #ffe0b2; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 0.95rem; line-height: 1.5; color: #5d4037; }
        .link-btn { display: block; width: 100%; text-align: center; padding: 12px; border-radius: 8px; text-decoration: none; font-weight: bold; margin-bottom: 10px; transition: 0.2s; box-sizing: border-box; }
        .btn-test { background: #607d8b; color: white; }
        .btn-ans { background: #4caf50; color: white; margin-top: 15px; }
        .btn-kakao { background: #fee500; color: #3c1e1e; border: none; width: 100%; padding: 15px; border-radius: 10px; font-weight: bold; font-size: 1.1rem; cursor: pointer; margin: 20px 0; display: none; }
        .q-item { margin-bottom: 15px; padding-bottom